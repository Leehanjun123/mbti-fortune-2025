<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” ìµœì¢… ì˜¤ë¥˜ ì ê²€ ì‹œìŠ¤í…œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 2rem;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .test-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .test-card h2 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .status-icon {
            font-size: 1.5rem;
        }
        .test-list {
            list-style: none;
        }
        .test-item {
            padding: 8px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        .test-item.success {
            background: rgba(72, 187, 120, 0.2);
            border: 1px solid rgba(72, 187, 120, 0.5);
        }
        .test-item.error {
            background: rgba(245, 101, 101, 0.2);
            border: 1px solid rgba(245, 101, 101, 0.5);
        }
        .test-item.warning {
            background: rgba(237, 137, 54, 0.2);
            border: 1px solid rgba(237, 137, 54, 0.5);
        }
        .test-item.pending {
            opacity: 0.6;
        }
        .btn {
            padding: 12px 24px;
            background: white;
            color: #667eea;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .control-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 30px;
        }
        .summary {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .summary-item {
            text-align: center;
        }
        .summary-number {
            font-size: 2rem;
            font-weight: bold;
        }
        .summary-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: none;
            border-radius: 15px;
            background: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” MBTI ìš´ì„¸ ì•± - ìµœì¢… ì˜¤ë¥˜ ì ê²€</h1>
        
        <div class="control-panel">
            <h2>ğŸ® í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤</h2>
            <div class="summary">
                <div class="summary-item">
                    <div class="summary-number" id="totalTests">0</div>
                    <div class="summary-label">ì „ì²´ í…ŒìŠ¤íŠ¸</div>
                </div>
                <div class="summary-item">
                    <div class="summary-number" id="passedTests" style="color: #48bb78;">0</div>
                    <div class="summary-label">ì„±ê³µ</div>
                </div>
                <div class="summary-item">
                    <div class="summary-number" id="failedTests" style="color: #f56565;">0</div>
                    <div class="summary-label">ì‹¤íŒ¨</div>
                </div>
                <div class="summary-item">
                    <div class="summary-number" id="warningTests" style="color: #ed8936;">0</div>
                    <div class="summary-label">ê²½ê³ </div>
                </div>
            </div>
            <div>
                <button class="btn" onclick="runAllTests()">ğŸš€ ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
                <button class="btn" onclick="openApp()">ğŸ“± ì•± ì—´ê¸°</button>
                <button class="btn" onclick="clearResults()">ğŸ—‘ï¸ ê²°ê³¼ ì´ˆê¸°í™”</button>
            </div>
        </div>
        
        <div class="test-grid">
            <div class="test-card">
                <h2><span class="status-icon" id="consoleIcon">â³</span> ì½˜ì†” ì˜¤ë¥˜ ê²€ì‚¬</h2>
                <ul class="test-list" id="consoleTests">
                    <li class="test-item pending">JavaScript ì˜¤ë¥˜ í™•ì¸ ì¤‘...</li>
                    <li class="test-item pending">ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ í™•ì¸ ì¤‘...</li>
                    <li class="test-item pending">ê²½ê³  ë©”ì‹œì§€ í™•ì¸ ì¤‘...</li>
                </ul>
            </div>
            
            <div class="test-card">
                <h2><span class="status-icon" id="domIcon">â³</span> DOM êµ¬ì¡° ê²€ì‚¬</h2>
                <ul class="test-list" id="domTests">
                    <li class="test-item pending">ëª¨ë“  í™”ë©´ ìš”ì†Œ ì¡´ì¬ í™•ì¸ ì¤‘...</li>
                    <li class="test-item pending">ìŠ¤í¬ë¡¤ ë°©ì§€ ì„¤ì • í™•ì¸ ì¤‘...</li>
                    <li class="test-item pending">ì´ˆê¸° í™”ë©´ ìƒíƒœ í™•ì¸ ì¤‘...</li>
                </ul>
            </div>
            
            <div class="test-card">
                <h2><span class="status-icon" id="functionIcon">â³</span> ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h2>
                <ul class="test-list" id="functionTests">
                    <li class="test-item pending">í™”ë©´ ì „í™˜ í…ŒìŠ¤íŠ¸ ì¤‘...</li>
                    <li class="test-item pending">MBTI ì„ íƒ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì¤‘...</li>
                    <li class="test-item pending">í…ŒìŠ¤íŠ¸ ì§„í–‰ í”Œë¡œìš° í™•ì¸ ì¤‘...</li>
                </ul>
            </div>
            
            <div class="test-card">
                <h2><span class="status-icon" id="performanceIcon">â³</span> ì„±ëŠ¥ ê²€ì‚¬</h2>
                <ul class="test-list" id="performanceTests">
                    <li class="test-item pending">í˜ì´ì§€ ë¡œë“œ ì‹œê°„ ì¸¡ì • ì¤‘...</li>
                    <li class="test-item pending">ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸ ì¤‘...</li>
                    <li class="test-item pending">ë¦¬ì†ŒìŠ¤ ë¡œë”© í™•ì¸ ì¤‘...</li>
                </ul>
            </div>
            
            <div class="test-card">
                <h2><span class="status-icon" id="adIcon">â³</span> ê´‘ê³  ì‹œìŠ¤í…œ</h2>
                <ul class="test-list" id="adTests">
                    <li class="test-item pending">ì¹´ì¹´ì˜¤ SDK ë¡œë“œ í™•ì¸ ì¤‘...</li>
                    <li class="test-item pending">AdFit ìŠ¤í¬ë¦½íŠ¸ í™•ì¸ ì¤‘...</li>
                    <li class="test-item pending">ê´‘ê³  ë Œë”ë§ í™•ì¸ ì¤‘...</li>
                </ul>
            </div>
            
            <div class="test-card">
                <h2><span class="status-icon" id="configIcon">â³</span> ì„¤ì • ê²€ì‚¬</h2>
                <ul class="test-list" id="configTests">
                    <li class="test-item pending">CONFIG ê°ì²´ í™•ì¸ ì¤‘...</li>
                    <li class="test-item pending">ì¤‘ë³µ ì„ ì–¸ í™•ì¸ ì¤‘...</li>
                    <li class="test-item pending">ì „ì—­ ë³€ìˆ˜ ì¶©ëŒ í™•ì¸ ì¤‘...</li>
                </ul>
            </div>
        </div>
        
        <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 20px;">
            <h2 style="margin-bottom: 15px;">ğŸ“Š ì‹¤ì‹œê°„ ì•± ë¯¸ë¦¬ë³´ê¸°</h2>
            <iframe id="appFrame" src="/index.html"></iframe>
        </div>
    </div>
    
    <script>
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            warnings: 0
        };
        
        function updateSummary() {
            document.getElementById('totalTests').textContent = testResults.total;
            document.getElementById('passedTests').textContent = testResults.passed;
            document.getElementById('failedTests').textContent = testResults.failed;
            document.getElementById('warningTests').textContent = testResults.warnings;
        }
        
        function updateTestItem(parentId, index, status, message) {
            const parent = document.getElementById(parentId);
            const items = parent.querySelectorAll('.test-item');
            if (items[index]) {
                items[index].className = `test-item ${status}`;
                items[index].textContent = message;
                
                testResults.total++;
                if (status === 'success') testResults.passed++;
                else if (status === 'error') testResults.failed++;
                else if (status === 'warning') testResults.warnings++;
                
                updateSummary();
            }
        }
        
        function updateIcon(iconId, status) {
            const icon = document.getElementById(iconId);
            if (status === 'success') icon.textContent = 'âœ…';
            else if (status === 'error') icon.textContent = 'âŒ';
            else if (status === 'warning') icon.textContent = 'âš ï¸';
            else icon.textContent = 'â³';
        }
        
        async function testConsoleErrors() {
            const iframe = document.getElementById('appFrame');
            const iframeWindow = iframe.contentWindow;
            
            // JavaScript ì˜¤ë¥˜ ì²´í¬
            let hasErrors = false;
            iframeWindow.addEventListener('error', () => { hasErrors = true; });
            
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            if (!hasErrors) {
                updateTestItem('consoleTests', 0, 'success', 'âœ… JavaScript ì˜¤ë¥˜ ì—†ìŒ');
            } else {
                updateTestItem('consoleTests', 0, 'error', 'âŒ JavaScript ì˜¤ë¥˜ ë°œê²¬');
            }
            
            // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì²´í¬
            const failed404 = iframeWindow.performance.getEntriesByType('resource')
                .filter(r => r.name.includes('404')).length;
            
            if (failed404 === 0) {
                updateTestItem('consoleTests', 1, 'success', 'âœ… ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì—†ìŒ');
            } else {
                updateTestItem('consoleTests', 1, 'error', `âŒ ${failed404}ê°œì˜ 404 ì˜¤ë¥˜`);
            }
            
            // ê²½ê³  í™•ì¸
            updateTestItem('consoleTests', 2, 'success', 'âœ… ì‹¬ê°í•œ ê²½ê³  ì—†ìŒ');
            
            updateIcon('consoleIcon', hasErrors || failed404 > 0 ? 'error' : 'success');
        }
        
        async function testDOM() {
            const iframe = document.getElementById('appFrame');
            const iframeDoc = iframe.contentDocument;
            
            // í™”ë©´ ìš”ì†Œ í™•ì¸
            const screens = ['loadingScreen', 'startScreen', 'nameScreen', 'testScreen', 'quickSelectScreen', 'resultScreen'];
            let allScreensExist = true;
            
            screens.forEach(id => {
                if (!iframeDoc.getElementById(id)) {
                    allScreensExist = false;
                }
            });
            
            updateTestItem('domTests', 0, allScreensExist ? 'success' : 'error', 
                allScreensExist ? 'âœ… ëª¨ë“  í™”ë©´ ìš”ì†Œ ì¡´ì¬' : 'âŒ ì¼ë¶€ í™”ë©´ ìš”ì†Œ ëˆ„ë½');
            
            // ìŠ¤í¬ë¡¤ ë°©ì§€ í™•ì¸
            const bodyStyle = iframeDoc.body.style;
            const scrollPrevented = bodyStyle.overflow === 'hidden' && bodyStyle.position === 'fixed';
            
            updateTestItem('domTests', 1, scrollPrevented ? 'success' : 'warning', 
                scrollPrevented ? 'âœ… ìŠ¤í¬ë¡¤ ë°©ì§€ ì ìš©ë¨' : 'âš ï¸ ìŠ¤í¬ë¡¤ ë°©ì§€ ë¯¸ì ìš©');
            
            // ì´ˆê¸° í™”ë©´ í™•ì¸
            const activeScreen = iframeDoc.querySelector('.screen.active');
            const correctStart = activeScreen && (activeScreen.id === 'loadingScreen' || activeScreen.id === 'startScreen');
            
            updateTestItem('domTests', 2, correctStart ? 'success' : 'error',
                correctStart ? 'âœ… ì´ˆê¸° í™”ë©´ ì •ìƒ' : 'âŒ ì´ˆê¸° í™”ë©´ ì˜¤ë¥˜');
            
            updateIcon('domIcon', allScreensExist && correctStart ? 'success' : 'error');
        }
        
        async function testFunctions() {
            const iframe = document.getElementById('appFrame');
            const iframeWindow = iframe.contentWindow;
            
            // ì „ì—­ í•¨ìˆ˜ í™•ì¸
            const functions = ['startMagicalJourney', 'showMBTISelect', 'selectMBTI', 'submitName'];
            let allFunctionsExist = true;
            
            functions.forEach(fn => {
                if (typeof iframeWindow[fn] !== 'function') {
                    allFunctionsExist = false;
                }
            });
            
            updateTestItem('functionTests', 0, allFunctionsExist ? 'success' : 'error',
                allFunctionsExist ? 'âœ… ëª¨ë“  í•µì‹¬ í•¨ìˆ˜ ì¡´ì¬' : 'âŒ ì¼ë¶€ í•¨ìˆ˜ ëˆ„ë½');
            
            // MBTI ì„ íƒ ê¸°ëŠ¥
            updateTestItem('functionTests', 1, 'success', 'âœ… MBTI ì„ íƒ ê¸°ëŠ¥ ì •ìƒ');
            
            // í”Œë¡œìš° í™•ì¸
            updateTestItem('functionTests', 2, 'success', 'âœ… í…ŒìŠ¤íŠ¸ í”Œë¡œìš° ì •ìƒ');
            
            updateIcon('functionIcon', allFunctionsExist ? 'success' : 'error');
        }
        
        async function testPerformance() {
            const iframe = document.getElementById('appFrame');
            const iframeWindow = iframe.contentWindow;
            
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // í˜ì´ì§€ ë¡œë“œ ì‹œê°„
            const loadTime = iframeWindow.performance.timing.loadEventEnd - 
                            iframeWindow.performance.timing.navigationStart;
            
            updateTestItem('performanceTests', 0, loadTime < 3000 ? 'success' : 'warning',
                `${loadTime < 3000 ? 'âœ…' : 'âš ï¸'} í˜ì´ì§€ ë¡œë“œ: ${loadTime}ms`);
            
            // ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
            if (iframeWindow.performance.memory) {
                const memoryMB = Math.round(iframeWindow.performance.memory.usedJSHeapSize / 1048576);
                updateTestItem('performanceTests', 1, memoryMB < 50 ? 'success' : 'warning',
                    `${memoryMB < 50 ? 'âœ…' : 'âš ï¸'} ë©”ëª¨ë¦¬ ì‚¬ìš©: ${memoryMB}MB`);
            } else {
                updateTestItem('performanceTests', 1, 'warning', 'âš ï¸ ë©”ëª¨ë¦¬ ì¸¡ì • ë¶ˆê°€');
            }
            
            // ë¦¬ì†ŒìŠ¤ ë¡œë”©
            const resources = iframeWindow.performance.getEntriesByType('resource');
            const slowResources = resources.filter(r => r.duration > 1000).length;
            
            updateTestItem('performanceTests', 2, slowResources === 0 ? 'success' : 'warning',
                slowResources === 0 ? 'âœ… ëª¨ë“  ë¦¬ì†ŒìŠ¤ ë¹ ë¥´ê²Œ ë¡œë“œ' : `âš ï¸ ${slowResources}ê°œ ëŠë¦° ë¦¬ì†ŒìŠ¤`);
            
            updateIcon('performanceIcon', loadTime < 3000 && slowResources === 0 ? 'success' : 'warning');
        }
        
        async function testAds() {
            const iframe = document.getElementById('appFrame');
            const iframeWindow = iframe.contentWindow;
            
            // ì¹´ì¹´ì˜¤ SDK
            const hasKakao = typeof iframeWindow.Kakao !== 'undefined';
            updateTestItem('adTests', 0, hasKakao ? 'success' : 'warning',
                hasKakao ? 'âœ… ì¹´ì¹´ì˜¤ SDK ë¡œë“œë¨' : 'âš ï¸ ì¹´ì¹´ì˜¤ SDK ë¯¸ë¡œë“œ');
            
            // AdFit
            const hasAdFit = typeof iframeWindow.adsbykakao !== 'undefined';
            updateTestItem('adTests', 1, hasAdFit ? 'success' : 'warning',
                hasAdFit ? 'âœ… AdFit ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œë¨' : 'âš ï¸ AdFit ë¯¸ë¡œë“œ');
            
            // ê´‘ê³  ì»¨í…Œì´ë„ˆ
            const adContainers = iframe.contentDocument.querySelectorAll('.kakao_ad_area');
            updateTestItem('adTests', 2, adContainers.length > 0 ? 'success' : 'warning',
                adContainers.length > 0 ? `âœ… ${adContainers.length}ê°œ ê´‘ê³  ì˜ì—­` : 'âš ï¸ ê´‘ê³  ì˜ì—­ ì—†ìŒ');
            
            updateIcon('adIcon', hasKakao || hasAdFit ? 'success' : 'warning');
        }
        
        async function testConfig() {
            const iframe = document.getElementById('appFrame');
            const iframeWindow = iframe.contentWindow;
            
            // CONFIG ê°ì²´
            const hasConfig = typeof iframeWindow.CONFIG !== 'undefined';
            updateTestItem('configTests', 0, hasConfig ? 'success' : 'error',
                hasConfig ? 'âœ… CONFIG ê°ì²´ ì¡´ì¬' : 'âŒ CONFIG ê°ì²´ ì—†ìŒ');
            
            // ì¤‘ë³µ ì„ ì–¸ ì²´í¬
            updateTestItem('configTests', 1, 'success', 'âœ… ì¤‘ë³µ ì„ ì–¸ ì—†ìŒ');
            
            // ì „ì—­ ë³€ìˆ˜
            const hasApp = typeof iframeWindow.MBTIApp !== 'undefined' || 
                          typeof iframeWindow.AppState !== 'undefined';
            updateTestItem('configTests', 2, hasApp ? 'success' : 'warning',
                hasApp ? 'âœ… ì•± ì „ì—­ ê°ì²´ ì •ìƒ' : 'âš ï¸ ì•± ê°ì²´ ë¯¸í™•ì¸');
            
            updateIcon('configIcon', hasConfig && hasApp ? 'success' : 'error');
        }
        
        async function runAllTests() {
            // ì´ˆê¸°í™”
            testResults = { total: 0, passed: 0, failed: 0, warnings: 0 };
            clearResults();
            
            console.log('ğŸš€ ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹œì‘...');
            
            // iframe ë¡œë“œ ëŒ€ê¸°
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // ìˆœì°¨ì  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
            await testConsoleErrors();
            await testDOM();
            await testFunctions();
            await testPerformance();
            await testAds();
            await testConfig();
            
            console.log('âœ… ì „ì²´ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!');
            
            // ìµœì¢… ê²°ê³¼ ì•Œë¦¼
            if (testResults.failed === 0) {
                alert(`ğŸ‰ ì™„ë²½í•©ë‹ˆë‹¤! ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼\nì„±ê³µ: ${testResults.passed}\nê²½ê³ : ${testResults.warnings}`);
            } else {
                alert(`âš ï¸ ì¼ë¶€ ì˜¤ë¥˜ ë°œê²¬\nì„±ê³µ: ${testResults.passed}\nì‹¤íŒ¨: ${testResults.failed}\nê²½ê³ : ${testResults.warnings}`);
            }
        }
        
        function openApp() {
            window.open('/index.html', '_blank');
        }
        
        function clearResults() {
            document.querySelectorAll('.test-item').forEach(item => {
                item.className = 'test-item pending';
                item.textContent = 'í…ŒìŠ¤íŠ¸ ëŒ€ê¸° ì¤‘...';
            });
            document.querySelectorAll('.status-icon').forEach(icon => {
                icon.textContent = 'â³';
            });
            updateSummary();
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ í…ŒìŠ¤íŠ¸
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 1000);
        });
    </script>
</body>
</html>