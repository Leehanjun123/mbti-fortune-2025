<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” í™”ë©´ ë¬¸ì œ ì§„ë‹¨</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .debug-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .debug-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .debug-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        .issue-list {
            list-style: none;
            padding: 0;
        }
        .issue-item {
            padding: 10px;
            margin: 5px 0;
            border-left: 4px solid #f56565;
            background: #fff5f5;
            font-size: 14px;
        }
        .issue-item.warning {
            border-color: #ed8936;
            background: #fffdf5;
        }
        .issue-item.info {
            border-color: #4299e1;
            background: #f0f9ff;
        }
        .preview-frame {
            width: 100%;
            height: 600px;
            border: 2px solid #ddd;
            border-radius: 10px;
        }
        .fix-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .fix-button:hover {
            opacity: 0.9;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-bad { background: #f56565; }
        .status-warning { background: #ed8936; }
        .status-good { background: #48bb78; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” MBTI ìš´ì„¸ ì•± - í™”ë©´ ë¬¸ì œ ì§„ë‹¨</h1>
        
        <div class="debug-grid">
            <div class="debug-section">
                <h2>ğŸ¨ ë°œê²¬ëœ UI ë¬¸ì œ</h2>
                <ul class="issue-list" id="uiIssues"></ul>
            </div>
            
            <div class="debug-section">
                <h2>ğŸ“± ë ˆì´ì•„ì›ƒ ë¬¸ì œ</h2>
                <ul class="issue-list" id="layoutIssues"></ul>
            </div>
            
            <div class="debug-section">
                <h2>ğŸ­ CSS ìŠ¤íƒ€ì¼ ë¬¸ì œ</h2>
                <ul class="issue-list" id="cssIssues"></ul>
            </div>
            
            <div class="debug-section">
                <h2>ğŸ“Š í™”ë©´ë³„ ìƒíƒœ</h2>
                <ul class="issue-list" id="screenStatus"></ul>
            </div>
        </div>
        
        <div style="text-align: center; margin: 30px 0;">
            <button class="fix-button" onclick="analyzeVisualProblems()">ğŸ” í™”ë©´ ë¬¸ì œ ë¶„ì„</button>
            <button class="fix-button" onclick="applyQuickFixes()">âš¡ ë¹ ë¥¸ ìˆ˜ì • ì ìš©</button>
            <button class="fix-button" onclick="openInNewTab()">ğŸ“± ìƒˆ íƒ­ì—ì„œ ì—´ê¸°</button>
        </div>
        
        <div class="debug-section">
            <h2>ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°</h2>
            <iframe id="appFrame" src="/index.html" class="preview-frame"></iframe>
        </div>
    </div>
    
    <script>
        function analyzeVisualProblems() {
            const iframe = document.getElementById('appFrame');
            const iframeDoc = iframe.contentDocument;
            const iframeWin = iframe.contentWindow;
            
            // UI ë¬¸ì œ ë¶„ì„
            const uiIssues = [];
            const layoutIssues = [];
            const cssIssues = [];
            const screenStatus = [];
            
            // 1. í™”ë©´ ê²¹ì¹¨ ê²€ì‚¬
            const screens = iframeDoc.querySelectorAll('.screen');
            let visibleScreens = 0;
            screens.forEach(screen => {
                const display = iframeWin.getComputedStyle(screen).display;
                const visibility = iframeWin.getComputedStyle(screen).visibility;
                
                if (display !== 'none' && visibility !== 'hidden') {
                    visibleScreens++;
                    screenStatus.push({
                        text: `${screen.id}: í‘œì‹œë¨`,
                        type: screen.classList.contains('active') ? 'info' : 'warning'
                    });
                }
            });
            
            if (visibleScreens > 1) {
                layoutIssues.push({
                    text: `âš ï¸ ${visibleScreens}ê°œì˜ í™”ë©´ì´ ë™ì‹œì— í‘œì‹œë¨`,
                    type: 'error'
                });
            }
            
            // 2. ìŠ¤í¬ë¡¤ ë¬¸ì œ ê²€ì‚¬
            const body = iframeDoc.body;
            const bodyOverflow = iframeWin.getComputedStyle(body).overflow;
            const bodyPosition = iframeWin.getComputedStyle(body).position;
            
            if (bodyOverflow !== 'hidden') {
                cssIssues.push({
                    text: `body overflowê°€ '${bodyOverflow}'ë¡œ ì„¤ì •ë¨ (hiddenì´ì–´ì•¼ í•¨)`,
                    type: 'error'
                });
            }
            
            if (bodyPosition !== 'fixed') {
                cssIssues.push({
                    text: `body positionì´ '${bodyPosition}'ë¡œ ì„¤ì •ë¨ (fixedì—¬ì•¼ í•¨)`,
                    type: 'warning'
                });
            }
            
            // 3. ê²°ê³¼ í™”ë©´ ì»¨í…ì¸  ê²€ì‚¬
            const resultScreen = iframeDoc.getElementById('resultScreen');
            if (resultScreen && resultScreen.classList.contains('active')) {
                const userName = iframeDoc.getElementById('userName');
                const userMBTI = iframeDoc.getElementById('userMBTI');
                const overallFortune = iframeDoc.getElementById('overallFortune');
                
                if (userName && !userName.textContent.trim()) {
                    uiIssues.push({
                        text: 'ì‚¬ìš©ì ì´ë¦„ì´ í‘œì‹œë˜ì§€ ì•ŠìŒ',
                        type: 'error'
                    });
                }
                
                if (userMBTI && !userMBTI.textContent.trim()) {
                    uiIssues.push({
                        text: 'MBTI íƒ€ì…ì´ í‘œì‹œë˜ì§€ ì•ŠìŒ',
                        type: 'error'
                    });
                }
                
                if (overallFortune && !overallFortune.textContent.trim()) {
                    uiIssues.push({
                        text: 'ìš´ì„¸ ë‚´ìš©ì´ í‘œì‹œë˜ì§€ ì•ŠìŒ',
                        type: 'error'
                    });
                }
            }
            
            // 4. ê´‘ê³  ì˜ì—­ ê²€ì‚¬
            const adContainers = iframeDoc.querySelectorAll('.ad-container');
            adContainers.forEach((ad, index) => {
                const height = ad.offsetHeight;
                if (height < 50) {
                    uiIssues.push({
                        text: `ê´‘ê³  ì˜ì—­ ${index + 1}ì´ ë„ˆë¬´ ì‘ìŒ (${height}px)`,
                        type: 'warning'
                    });
                }
            });
            
            // 5. ëª¨ë°”ì¼ ë°˜ì‘í˜• ê²€ì‚¬
            if (iframeWin.innerWidth < 768) {
                const containers = iframeDoc.querySelectorAll('.container');
                containers.forEach(container => {
                    const width = container.offsetWidth;
                    if (width > iframeWin.innerWidth) {
                        layoutIssues.push({
                            text: `ì»¨í…Œì´ë„ˆê°€ í™”ë©´ ë„ˆë¹„ë¥¼ ì´ˆê³¼ (${width}px > ${iframeWin.innerWidth}px)`,
                            type: 'error'
                        });
                    }
                });
            }
            
            // 6. z-index ë¬¸ì œ ê²€ì‚¬
            const elements = iframeDoc.querySelectorAll('*');
            const zIndexIssues = [];
            elements.forEach(el => {
                const zIndex = iframeWin.getComputedStyle(el).zIndex;
                if (zIndex && parseInt(zIndex) > 9999) {
                    zIndexIssues.push(el.className || el.id || 'unknown');
                }
            });
            
            if (zIndexIssues.length > 0) {
                cssIssues.push({
                    text: `ê³¼ë„í•œ z-index ì‚¬ìš©: ${zIndexIssues.join(', ')}`,
                    type: 'warning'
                });
            }
            
            // ê²°ê³¼ í‘œì‹œ
            displayIssues('uiIssues', uiIssues);
            displayIssues('layoutIssues', layoutIssues);
            displayIssues('cssIssues', cssIssues);
            displayIssues('screenStatus', screenStatus);
            
            // ìš”ì•½
            const totalIssues = uiIssues.length + layoutIssues.length + cssIssues.length;
            if (totalIssues === 0) {
                alert('âœ… í™”ë©´ ë¬¸ì œê°€ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!');
            } else {
                alert(`âš ï¸ ${totalIssues}ê°œì˜ ë¬¸ì œê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ìˆ˜ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.`);
            }
        }
        
        function displayIssues(elementId, issues) {
            const container = document.getElementById(elementId);
            container.innerHTML = '';
            
            if (issues.length === 0) {
                container.innerHTML = '<li class="issue-item info">ë¬¸ì œ ì—†ìŒ âœ…</li>';
                return;
            }
            
            issues.forEach(issue => {
                const li = document.createElement('li');
                li.className = `issue-item ${issue.type || ''}`;
                li.innerHTML = `
                    <span class="status-indicator status-${issue.type === 'error' ? 'bad' : issue.type === 'warning' ? 'warning' : 'good'}"></span>
                    ${issue.text || issue}
                `;
                container.appendChild(li);
            });
        }
        
        function applyQuickFixes() {
            const iframe = document.getElementById('appFrame');
            const iframeDoc = iframe.contentDocument;
            const iframeWin = iframe.contentWindow;
            
            // 1. ìŠ¤í¬ë¡¤ ë°©ì§€ ê°•ì œ ì ìš©
            iframeDoc.body.style.overflow = 'hidden';
            iframeDoc.body.style.position = 'fixed';
            iframeDoc.body.style.width = '100vw';
            iframeDoc.body.style.height = '100vh';
            iframeDoc.documentElement.style.overflow = 'hidden';
            
            // 2. ì¤‘ë³µ í™”ë©´ ìˆ¨ê¸°ê¸°
            const screens = iframeDoc.querySelectorAll('.screen');
            screens.forEach(screen => {
                if (!screen.classList.contains('active')) {
                    screen.style.display = 'none';
                }
            });
            
            // 3. ê´‘ê³  ì˜ì—­ ìµœì†Œ ë†’ì´ ì„¤ì •
            const adContainers = iframeDoc.querySelectorAll('.ad-container');
            adContainers.forEach(ad => {
                ad.style.minHeight = '100px';
                ad.style.background = '#f0f0f0';
            });
            
            alert('âš¡ ë¹ ë¥¸ ìˆ˜ì •ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¶„ì„í•´ë³´ì„¸ìš”.');
            
            // ì¬ë¶„ì„
            setTimeout(analyzeVisualProblems, 500);
        }
        
        function openInNewTab() {
            window.open('/index.html', '_blank');
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ë¶„ì„
        window.onload = () => {
            setTimeout(analyzeVisualProblems, 2000);
        };
    </script>
</body>
</html>