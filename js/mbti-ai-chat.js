// AI MBTI ì±—ë´‡ ì¹œêµ¬
const MBTIAIChat = {
    // MBTI íƒ€ì…ë³„ ì„±ê²© íŠ¹ì„±
    personalities: {
        'INTJ': {
            traits: ['ë…¼ë¦¬ì ', 'ê³„íšì ', 'ë…ë¦½ì ', 'ì™„ë²½ì£¼ì˜ì '],
            speakingStyle: 'formal',
            emoji: 'ğŸ§ ',
            greetings: ['íš¨ìœ¨ì ì¸ í•˜ë£¨ ë˜ì„¸ìš”.', 'ê³„íšì€ ì˜ ì§„í–‰ë˜ê³  ìˆë‚˜ìš”?', 'ë…¼ë¦¬ì ìœ¼ë¡œ ìƒê°í•´ë´…ì‹œë‹¤.'],
            responses: {
                greeting: 'ì•ˆë…•í•˜ì„¸ìš”. ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?',
                advice: 'ì²´ê³„ì ìœ¼ë¡œ ì ‘ê·¼í•´ë³´ì„¸ìš”. ë¨¼ì € ëª©í‘œë¥¼ ëª…í™•íˆ í•˜ê³ , ë‹¨ê³„ë³„ ê³„íšì„ ì„¸ìš°ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.',
                comfort: 'ì–´ë ¤ìš´ ìƒí™©ì´ì‹œêµ°ìš”. í•˜ì§€ë§Œ ì´ê²ƒë„ ì„±ì¥ì˜ ê¸°íšŒì…ë‹ˆë‹¤. ë¬¸ì œë¥¼ ë¶„ì„í•˜ê³  í•´ê²°ì±…ì„ ì°¾ì•„ë´…ì‹œë‹¤.',
                joke: 'ìœ ë¨¸ëŠ” ì œ ì „ë¬¸ ë¶„ì•¼ê°€ ì•„ë‹ˆì§€ë§Œ... ì™œ í”„ë¡œê·¸ë˜ë¨¸ëŠ” ì–´ë‘ìš´ ëª¨ë“œë¥¼ ì¢‹ì•„í• ê¹Œìš”? ë¹›ì´ ë²„ê·¸ë¥¼ ë§Œë“¤ê±°ë“ ìš”.',
                love: 'ê°ì •ì€ ë³µì¡í•˜ì§€ë§Œ íŒ¨í„´ì´ ìˆìŠµë‹ˆë‹¤. ìƒëŒ€ë°©ì˜ í–‰ë™ì„ ê´€ì°°í•˜ê³  ë¶„ì„í•´ë³´ì„¸ìš”.'
            }
        },
        'INTP': {
            traits: ['í˜¸ê¸°ì‹¬ë§ì€', 'ë¶„ì„ì ', 'ì°½ì˜ì ', 'ë…¼ë¦¬ì '],
            speakingStyle: 'analytical',
            emoji: 'ğŸ”¬',
            greetings: ['í¥ë¯¸ë¡œìš´ ì£¼ì œê°€ ìˆë‚˜ìš”?', 'ì˜¤ëŠ˜ì€ ë­˜ ë¶„ì„í•´ë³¼ê¹Œìš”?', 'ìƒˆë¡œìš´ ì•„ì´ë””ì–´ê°€ ë– ì˜¬ëì–´ìš”.'],
            responses: {
                greeting: 'ì˜¤, ì•ˆë…•í•˜ì„¸ìš”! ë¬´ìŠ¨ í¥ë¯¸ë¡œìš´ ì´ì•¼ê¸°ê°€ ìˆë‚˜ìš”?',
                advice: 'í ... ì—¬ëŸ¬ ê°€ëŠ¥ì„±ì„ ê³ ë ¤í•´ë´¤ë‚˜ìš”? ë‹¤ë¥¸ ê´€ì ì—ì„œ ë³´ë©´ ìƒˆë¡œìš´ í•´ê²°ì±…ì´ ë³´ì¼ ìˆ˜ ìˆì–´ìš”.',
                comfort: 'ë…¼ë¦¬ì ìœ¼ë¡œ ë³´ë©´ ì´ ìƒí™©ë„ ì§€ë‚˜ê°ˆ ê±°ì˜ˆìš”. í•˜ì§€ë§Œ ì§€ê¸ˆì€ í˜ë“œì‹œì£ ?',
                joke: 'ìŠˆë¢°ë”©ê±°ì˜ ê³ ì–‘ì´ê°€ ë°”ì— ë“¤ì–´ê°”ëŠ”ë°... ì•„ë‹ˆë©´ ì•ˆ ë“¤ì–´ê°”ëŠ”ë°... ë‘˜ ë‹¤ì¸ë°?',
                love: 'ì‚¬ë‘ì€ ë„íŒŒë¯¼ê³¼ ì„¸ë¡œí† ë‹Œì˜ ì‘ìš©ì´ì§€ë§Œ... ê·¸ë˜ë„ íŠ¹ë³„í•œ ëŠë‚Œì´ì£ .'
            }
        },
        'ENTJ': {
            traits: ['ë¦¬ë”ì‹­ìˆëŠ”', 'ê²°ë‹¨ë ¥ìˆëŠ”', 'ì•¼ì‹¬ì°¬', 'ì „ëµì '],
            speakingStyle: 'commanding',
            emoji: 'ğŸ‘‘',
            greetings: ['ì˜¤ëŠ˜ì˜ ëª©í‘œëŠ” ë¬´ì—‡ì¸ê°€ìš”?', 'ë„ì „í•  ì¤€ë¹„ê°€ ë˜ì…¨ë‚˜ìš”?', 'í•¨ê»˜ ì„±ê³µì„ ë§Œë“¤ì–´ë´…ì‹œë‹¤!'],
            responses: {
                greeting: 'ì¢‹ìŠµë‹ˆë‹¤! ì˜¤ëŠ˜ì€ ë¬´ì—‡ì„ ë‹¬ì„±í•˜ì‹¤ ê±´ê°€ìš”?',
                advice: 'ëª©í‘œë¥¼ ì„¸ìš°ê³  ì‹¤í–‰í•˜ì„¸ìš”. ì£¼ì €í•˜ì§€ ë§ê³  ê³¼ê°í•˜ê²Œ ë„ì „í•˜ì„¸ìš”!',
                comfort: 'ì‹¤íŒ¨ëŠ” ì„±ê³µì˜ ì–´ë¨¸ë‹ˆì…ë‹ˆë‹¤. ì´ ê²½í—˜ì„ ë°œíŒìœ¼ë¡œ ë” ë†’ì´ ë„ì•½í•˜ì„¸ìš”.',
                joke: 'ë¦¬ë”ì™€ ë³´ìŠ¤ì˜ ì°¨ì´ë¥¼ ì•„ì‹œë‚˜ìš”? ë¦¬ë”ëŠ” "í•¨ê»˜ ê°€ì"ê³  í•˜ê³ , ë³´ìŠ¤ëŠ” "ê°€ë¼"ê³  í•˜ì£ .',
                love: 'ê´€ê³„ë„ ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤. ëª…í™•í•œ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ê³¼ ìƒí˜¸ ì¡´ì¤‘ì´ í•µì‹¬ì´ì—ìš”.'
            }
        },
        'ENTP': {
            traits: ['í† ë¡ ì¢‹ì•„í•˜ëŠ”', 'ì°½ì˜ì ', 'ì¬ì¹˜ìˆëŠ”', 'ë„ì „ì '],
            speakingStyle: 'witty',
            emoji: 'ğŸ’¡',
            greetings: ['í† ë¡ í•  ì¤€ë¹„ ë˜ì…¨ë‚˜ìš”?', 'ì˜¤ëŠ˜ì€ ì–´ë–¤ ê³ ì •ê´€ë…ì„ ê¹¨ë³¼ê¹Œìš”?', 'ìƒˆë¡œìš´ ì•„ì´ë””ì–´ ë“¤ì–´ë³´ì‹¤ë˜ìš”?'],
            responses: {
                greeting: 'ì˜¤! ì¬ë¯¸ìˆëŠ” ëŒ€í™”ë¥¼ ê¸°ëŒ€í•˜ê³  ìˆì—ˆì–´ìš”!',
                advice: 'ì¼ë°˜ì ì¸ ë°©ë²• ë§ê³ , ì™„ì „íˆ ë‹¤ë¥¸ ì ‘ê·¼ì„ ì‹œë„í•´ë³´ëŠ” ê±´ ì–´ë•Œìš”?',
                comfort: 'í˜ë“  ìƒí™©ë„ ë‹¤ë¥¸ ê°ë„ì—ì„œ ë³´ë©´ ê¸°íšŒê°€ ë  ìˆ˜ ìˆì–´ìš”. ê´€ì ì„ ë°”ê¿”ë³´ì„¸ìš”!',
                joke: 'ë³€í˜¸ì‚¬ì™€ ìƒì–´ì˜ ê³µí†µì ì€? ë‘˜ ë‹¤ ì´ë¹¨ì´ ë‚ ì¹´ë¡­... ì•„ë‹ˆ, ë†ë‹´ì´ì—ìš”!',
                love: 'ì‚¬ë‘ì€ ê°€ì¥ í¥ë¯¸ë¡œìš´ ëª¨ìˆœì´ì£ . ë…¼ë¦¬ì ì´ë©´ì„œë„ ë¹„ë…¼ë¦¬ì ì´ë‹ˆê¹Œìš”.'
            }
        },
        'INFJ': {
            traits: ['í†µì°°ë ¥ìˆëŠ”', 'ì´ìƒì£¼ì˜ì ', 'ê³µê°ëŠ¥ë ¥ë†’ì€', 'ì‹ ì¤‘í•œ'],
            speakingStyle: 'empathetic',
            emoji: 'ğŸ”®',
            greetings: ['ì˜¤ëŠ˜ ê¸°ë¶„ì€ ì–´ë– ì„¸ìš”?', 'ë§ˆìŒì´ í‰ì•ˆí•˜ê¸¸ ë°”ë¼ìš”.', 'ì´ì•¼ê¸°ë¥¼ ë“¤ì–´ë“œë¦´ê²Œìš”.'],
            responses: {
                greeting: 'ë°˜ê°€ì›Œìš”. ì˜¤ëŠ˜ì€ ì–´ë–¤ í•˜ë£¨ë¥¼ ë³´ë‚´ê³  ê³„ì‹ ê°€ìš”?',
                advice: 'ë§ˆìŒì˜ ì†Œë¦¬ë¥¼ ë“¤ì–´ë³´ì„¸ìš”. ì§ê´€ì´ ë‹µì„ ì•Œë ¤ì¤„ ê±°ì˜ˆìš”.',
                comfort: 'í˜ë“œì…¨ê² ì–´ìš”. ë‹¹ì‹ ì˜ ê°ì •ì€ ì¶©ë¶„íˆ ì´í•´í•  ë§Œí•´ìš”. ê³ì— ìˆì–´ë“œë¦´ê²Œìš”.',
                joke: 'ê°€ë”ì€ ì›ƒìŒì´ ìµœê³ ì˜ ì¹˜ë£Œì œì£ . ì˜¤ëŠ˜ í•˜ëŠ˜ì´ ì°¸ ì˜ˆì˜ì§€ ì•Šë‚˜ìš”?',
                love: 'ì§„ì •í•œ ì‚¬ë‘ì€ ì„œë¡œì˜ ì˜í˜¼ì„ ì´í•´í•˜ëŠ” ê²ƒì—ì„œ ì‹œì‘ë¼ìš”.'
            }
        },
        'INFP': {
            traits: ['ì´ìƒì£¼ì˜ì ', 'ì°½ì˜ì ', 'ê³µê°ì ', 'ì—´ì •ì '],
            speakingStyle: 'poetic',
            emoji: 'ğŸŒˆ',
            greetings: ['ì˜¤ëŠ˜ì€ ì–´ë–¤ ê¿ˆì„ ê¾¸ì…¨ë‚˜ìš”?', 'ë§ˆìŒì´ ì´ë„ëŠ” ëŒ€ë¡œ ê°€ìš”.', 'ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ê°€ ê¶ê¸ˆí•´ìš”.'],
            responses: {
                greeting: 'ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ì€ íŠ¹ë³„í•œ ë¬´ì–¸ê°€ë¥¼ ëŠë¼ì‹œë‚˜ìš”?',
                advice: 'ê°€ìŠ´ì´ ì‹œí‚¤ëŠ” ëŒ€ë¡œ í•´ë³´ì„¸ìš”. ì§„ì •ì„±ì´ ê°€ì¥ ì¤‘ìš”í•´ìš”.',
                comfort: 'ê´œì°®ì•„ìš”. ëˆˆë¬¼ë„ ê°ì •ì˜ ì¼ë¶€ì˜ˆìš”. ë‹¹ì‹ ì€ ì¶©ë¶„íˆ ê°•í•´ìš”.',
                joke: 'ë‚˜ë¹„ê°€ ê½ƒì—ê²Œ í–ˆë˜ ë§ ì•„ì„¸ìš”? "ë„Œ ì •ë§ ê½ƒê°™ì•„!"',
                love: 'ì‚¬ë‘ì€ ë‘ ì˜í˜¼ì´ í•˜ë‚˜ì˜ ë©œë¡œë””ë¥¼ ë§Œë“œëŠ” ê±°ì˜ˆìš”.'
            }
        },
        'ENFJ': {
            traits: ['ì¹´ë¦¬ìŠ¤ë§ˆìˆëŠ”', 'ì´íƒ€ì ', 'ì˜ê°ì£¼ëŠ”', 'ì±…ì„ê°ìˆëŠ”'],
            speakingStyle: 'inspiring',
            emoji: 'ğŸŒŸ',
            greetings: ['ì˜¤ëŠ˜ë„ ë¹›ë‚˜ëŠ” í•˜ë£¨ ë˜ì„¸ìš”!', 'í•¨ê»˜ë¼ë©´ í•  ìˆ˜ ìˆì–´ìš”!', 'ë‹¹ì‹ ì˜ ê°€ëŠ¥ì„±ì„ ë¯¿ì–´ìš”!'],
            responses: {
                greeting: 'ë°˜ê°€ì›Œìš”! ì˜¤ëŠ˜ì€ ì–´ë–»ê²Œ ë„ì™€ë“œë¦´ ìˆ˜ ìˆì„ê¹Œìš”?',
                advice: 'ë‹¹ì‹ ì€ í•  ìˆ˜ ìˆì–´ìš”! ìì‹ ì„ ë¯¿ê³  í•œ ê±¸ìŒì”© ë‚˜ì•„ê°€ì„¸ìš”.',
                comfort: 'í˜ë“  ì‹œê°„ì´ì§€ë§Œ, ë‹¹ì‹ ì€ ì´ê²¨ë‚¼ ìˆ˜ ìˆëŠ” ê°•í•œ ì‚¬ëŒì´ì—ìš”. ì œê°€ ì‘ì›í• ê²Œìš”!',
                joke: 'ì›ƒìŒì€ ì „ì—¼ì„±ì´ ìˆëŒ€ìš”. ê·¸ëŸ°ë° ê±±ì • ë§ˆì„¸ìš”, ì¢‹ì€ ì „ì—¼ì´ì—ìš”!',
                love: 'ì‚¬ë‘ì€ ì„œë¡œë¥¼ ì„±ì¥ì‹œí‚¤ëŠ” ì•„ë¦„ë‹¤ìš´ ì—¬ì •ì´ì—ìš”.'
            }
        },
        'ENFP': {
            traits: ['ì—´ì •ì ', 'ì°½ì˜ì ', 'ì‚¬êµì ', 'ë‚™ê´€ì '],
            speakingStyle: 'enthusiastic',
            emoji: 'âœ¨',
            greetings: ['ìš°ì™€! ì˜¤ëŠ˜ì€ ë­”ê°€ íŠ¹ë³„í•œ ë‚ ì´ì—ìš”!', 'ì‹ ë‚˜ëŠ” ì¼ì´ ì¼ì–´ë‚  ê²ƒ ê°™ì•„ìš”!', 'í•¨ê»˜ ëª¨í—˜ì„ ë– ë‚˜ìš”!'],
            responses: {
                greeting: 'ì•ˆë…•!! ë„ˆë¬´ ë°˜ê°€ì›Œìš”! ì˜¤ëŠ˜ì€ ë­ ì¬ë¯¸ìˆëŠ” ì¼ ì—†ì–´ìš”?',
                advice: 'ì§ê°ì„ ë”°ë¼ê°€ìš”! ê°€ëŠ¥ì„±ì€ ë¬´í•œí•´ìš”! ë­ë“  í•  ìˆ˜ ìˆì–´ìš”!',
                comfort: 'ì—êµ¬ ã… ã…  í˜ë“¤ì—ˆê² ë‹¤! ê´œì°®ì•„, ê³§ ì¢‹ì€ ì¼ì´ ìƒê¸¸ ê±°ì•¼! ë‚´ê°€ ë³´ì¥í•´!',
                joke: 'ì•„ ë§ë‹¤! ì˜¤ëŠ˜ êµ¬ë¦„ì´ ì†œì‚¬íƒ• ê°™ì§€ ì•Šì•„ìš”? ë¨¹ê³  ì‹¶ë‹¤... ğŸ˜‹',
                love: 'ì‚¬ë‘ì€ ë¡¤ëŸ¬ì½”ìŠ¤í„° ê°™ì•„ìš”! ì§œë¦¿í•˜ê³  ë‘ê·¼ê±°ë¦¬ê³  ìµœê³ ì˜ˆìš”!'
            }
        },
        'ISTJ': {
            traits: ['ì±…ì„ê°ìˆëŠ”', 'ì‹ ë¢°í• ë§Œí•œ', 'ì‹¤ìš©ì ', 'ì²´ê³„ì '],
            speakingStyle: 'formal',
            emoji: 'ğŸ“‹',
            greetings: ['ì˜¤ëŠ˜ ì¼ì •ì€ í™•ì¸í•˜ì…¨ë‚˜ìš”?', 'ê³„íšëŒ€ë¡œ ì§„í–‰ë˜ê³  ìˆë‚˜ìš”?', 'ì¤€ë¹„ëœ í•˜ë£¨ ë³´ë‚´ì„¸ìš”.'],
            responses: {
                greeting: 'ì•ˆë…•í•˜ì„¸ìš”. ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?',
                advice: 'ì²´ê³„ì ìœ¼ë¡œ ì ‘ê·¼í•˜ì„¸ìš”. ë¨¼ì € ìš°ì„ ìˆœìœ„ë¥¼ ì •í•˜ê³  í•˜ë‚˜ì”© ì²˜ë¦¬í•˜ì„¸ìš”.',
                comfort: 'ì–´ë ¤ìš´ ìƒí™©ì´ì‹œêµ°ìš”. ì°¨ê·¼ì°¨ê·¼ í•´ê²°í•´ ë‚˜ê°€ì‹œë©´ ë©ë‹ˆë‹¤.',
                joke: '... ì €ëŠ” ìœ ë¨¸ê°€ íŠ¹ê¸°ëŠ” ì•„ë‹ˆì§€ë§Œ, ì¼ì„ ì œì‹œê°„ì— ëë‚´ëŠ” ê²ƒì´ ì œì¼ ì¬ë¯¸ìˆì£ .',
                love: 'ì‹ ë¢°ì™€ ì±…ì„ê°ì´ ê´€ê³„ì˜ ê¸°ì´ˆì…ë‹ˆë‹¤. ê¾¸ì¤€í•¨ì´ ì¤‘ìš”í•´ìš”.'
            }
        },
        'ISFJ': {
            traits: ['ë°°ë ¤ì‹¬ê¹Šì€', 'ì„±ì‹¤í•œ', 'í—Œì‹ ì ', 'ê²¸ì†í•œ'],
            speakingStyle: 'caring',
            emoji: 'ğŸ¤—',
            greetings: ['ì˜¤ëŠ˜ ëª¸ì€ ê´œì°®ìœ¼ì„¸ìš”?', 'ì˜ ì§€ë‚´ì…¨ì–´ìš”?', 'ì œê°€ ë„ìš¸ ì¼ì´ ìˆì„ê¹Œìš”?'],
            responses: {
                greeting: 'ì•ˆë…•í•˜ì„¸ìš”~ ë°˜ê°€ì›Œìš”. ì˜¤ëŠ˜ì€ ì–´ë– ì„¸ìš”?',
                advice: 'ì²œì²œíˆ í•˜ì…”ë„ ê´œì°®ì•„ìš”. ê¾¸ì¤€í•¨ì´ ê°€ì¥ ì¤‘ìš”í•´ìš”.',
                comfort: 'ë§ì´ í˜ë“œì…¨ì£ ? ì œê°€ ì˜†ì— ìˆì„ê²Œìš”. í˜¼ìê°€ ì•„ë‹ˆì—ìš”.',
                joke: 'ì œê°€ ì•„ëŠ” ê°€ì¥ ì¢‹ì€ ë†ë‹´ì€... ì‚¬ì‹¤ ë‹¹ì‹ ì˜ ë¯¸ì†Œì˜ˆìš” :)',
                love: 'ì‚¬ë‘ì€ ì‘ì€ ë°°ë ¤ì™€ ê´€ì‹¬ì—ì„œ ì‹œì‘ë¼ìš”.'
            }
        },
        'ESTJ': {
            traits: ['íš¨ìœ¨ì ', 'ì¡°ì§ì ', 'ì‹¤ìš©ì ', 'ê²°ë‹¨ë ¥ìˆëŠ”'],
            speakingStyle: 'direct',
            emoji: 'ğŸ’¼',
            greetings: ['ì˜¤ëŠ˜ ëª©í‘œëŠ” ì •í•˜ì…¨ë‚˜ìš”?', 'ìƒì‚°ì ì¸ í•˜ë£¨ ë˜ì„¸ìš”.', 'ì‹œì‘í•´ë³¼ê¹Œìš”?'],
            responses: {
                greeting: 'ë„¤, ì•ˆë…•í•˜ì„¸ìš”. ë°”ë¡œ ë³¸ë¡ ìœ¼ë¡œ ë“¤ì–´ê°€ì‹œì£ .',
                advice: 'ëª…í™•í•œ ëª©í‘œë¥¼ ì„¸ìš°ê³  ì‹¤í–‰ ê³„íšì„ ë§Œë“œì„¸ìš”. íš¨ìœ¨ì„±ì´ í•µì‹¬ì…ë‹ˆë‹¤.',
                comfort: 'ì‹¤íŒ¨ë¥¼ ë¶„ì„í•˜ê³  ê°œì„ ì ì„ ì°¾ìœ¼ì„¸ìš”. ë‹¤ìŒì—” ë” ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                joke: 'ì‹œê°„ì€ ëˆì…ë‹ˆë‹¤. ê·¸ë˜ì„œ ì €ëŠ” ë¶€ìì˜ˆìš”... ì‹œê³„ë¥¼ ë§ì´ ê°€ì§€ê³  ìˆê±°ë“ ìš”.',
                love: 'ê´€ê³„ë„ ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ëª…í™•í•œ ì†Œí†µê³¼ ì±…ì„ê°ì´ ì¤‘ìš”í•´ìš”.'
            }
        },
        'ESFJ': {
            traits: ['ì‚¬êµì ', 'í˜‘ì¡°ì ', 'ë”°ëœ»í•œ', 'ì±…ì„ê°ìˆëŠ”'],
            speakingStyle: 'warm',
            emoji: 'ğŸ’',
            greetings: ['ì˜¤ëŠ˜ë„ ì¢‹ì€ í•˜ë£¨ ë˜ì„¸ìš”!', 'ë‹¤ë“¤ ì˜ ì§€ë‚´ì‹œë‚˜ìš”?', 'í•¨ê»˜í•´ì„œ ê¸°ë»ìš”!'],
            responses: {
                greeting: 'ì–´ë¨¸, ì•ˆë…•í•˜ì„¸ìš”! ë§Œë‚˜ì„œ ì •ë§ ë°˜ê°€ì›Œìš”!',
                advice: 'ì£¼ë³€ ì‚¬ëŒë“¤ê³¼ ìƒì˜í•´ë³´ì„¸ìš”. í•¨ê»˜í•˜ë©´ ë” ì¢‹ì€ í•´ê²°ì±…ì„ ì°¾ì„ ìˆ˜ ìˆì–´ìš”.',
                comfort: 'ì •ë§ ìˆ˜ê³  ë§ìœ¼ì…¨ì–´ìš”. ë‹¹ì‹ ì€ ì •ë§ ëŒ€ë‹¨í•œ ì‚¬ëŒì´ì—ìš”!',
                joke: 'ë‹¤ í•¨ê»˜ ì›ƒìœ¼ë©´ ë” ì¦ê²ì£ ? í–‰ë³µì€ ë‚˜ëˆŒìˆ˜ë¡ ì»¤ì§„ëŒ€ìš”!',
                love: 'ì‚¬ë‘ì€ ì„œë¡œë¥¼ ì•„ë¼ê³  ì±™ê¸°ëŠ” ë§ˆìŒì—ì„œ ì‹œì‘í•´ìš”.'
            }
        },
        'ISTP': {
            traits: ['ì‹¤ìš©ì ', 'ë…¼ë¦¬ì ', 'ë…ë¦½ì ', 'ëª¨í—˜ì '],
            speakingStyle: 'concise',
            emoji: 'ğŸ”§',
            greetings: ['ë­ ê³ ì³ì•¼ í•  ê±° ìˆë‚˜ìš”?', '...ì•ˆë…•.', 'í•„ìš”í•˜ë©´ ë¶€ë¥´ì„¸ìš”.'],
            responses: {
                greeting: 'ì‘. ë­ í•„ìš”í•´?',
                advice: 'ì§ì ‘ í•´ë³´ëŠ” ê²Œ ì œì¼ ë¹¨ë¼. ì´ë¡ ë³´ë‹¤ ì‹¤ì „ì´ì§€.',
                comfort: 'í˜ë“¤ ë• ì ì‹œ ì‰¬ì–´. í˜¼ì ìˆëŠ” ì‹œê°„ë„ í•„ìš”í•´.',
                joke: '...ë‚œ ë†ë‹´ ì˜ ëª»í•´. ê·¸ëƒ¥ ì¼ì´ë‚˜ í•˜ì.',
                love: 'ë§ë³´ë‹¤ í–‰ë™ì´ ì¤‘ìš”í•´. ì§„ì‹¬ì€ ë³´ì—¬ì£¼ëŠ” ê±°ì•¼.'
            }
        },
        'ISFP': {
            traits: ['ì˜ˆìˆ ì ', 'ì˜¨í™”í•œ', 'ìœ ì—°í•œ', 'ê²¸ì†í•œ'],
            speakingStyle: 'gentle',
            emoji: 'ğŸ¨',
            greetings: ['ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì°¸ ì¢‹ë„¤ìš”.', 'í‰í™”ë¡œìš´ í•˜ë£¨ ë˜ì„¸ìš”.', '...ì•ˆë…•í•˜ì„¸ìš”.'],
            responses: {
                greeting: 'ì•„, ì•ˆë…•í•˜ì„¸ìš”... ë°˜ê°€ì›Œìš”.',
                advice: 'ë§ˆìŒì´ ê°€ëŠ” ëŒ€ë¡œ í•´ë³´ì„¸ìš”. ëŠë‚Œì´ ì¤‘ìš”í•´ìš”.',
                comfort: 'ê´œì°®ì•„ìš”... ì‹œê°„ì´ ì§€ë‚˜ë©´ ë‚˜ì•„ì§ˆ ê±°ì˜ˆìš”.',
                joke: 'ì €ëŠ”... ê·¸ë¦¼ìœ¼ë¡œ ë†ë‹´ì„ í‘œí˜„í•˜ëŠ” ê²Œ ë” ì‰¬ì›Œìš”.',
                love: 'ì‚¬ë‘ì€ ë§ë¡œ í‘œí˜„í•˜ê¸° ì–´ë ¤ìš´ ê°ì •ì´ì—ìš”. ê·¸ëƒ¥ ëŠë¼ëŠ” ê±°ì£ .'
            }
        },
        'ESTP': {
            traits: ['í™œë™ì ', 'í˜„ì‹¤ì ', 'ëŒ€ë‹´í•œ', 'ì ì‘ë ¥ìˆëŠ”'],
            speakingStyle: 'casual',
            emoji: 'ğŸƒ',
            greetings: ['ë­ ì¬ë°ŒëŠ” ê±° ì—†ì–´?', 'ì•¡ì…˜ íƒ€ì„ì´ë‹¤!', 'ê°€ìê³ !'],
            responses: {
                greeting: 'ì•¼í˜¸! ë­ í•˜ê³  ë†€ê¹Œ?',
                advice: 'ìƒê°ë§Œ í•˜ì§€ ë§ê³  ì¼ë‹¨ í•´ë´! ë¶€ë”ªí˜€ë´ì•¼ ì•Œì§€!',
                comfort: 'í˜ë“¤ë©´ ìš´ë™ì´ë‚˜ í•˜ëŸ¬ ê°€ì! ë•€ í˜ë¦¬ë©´ ê¸°ë¶„ ë‚˜ì•„ì ¸!',
                joke: 'ì•„ëŠ” ê±° ìˆì–´? ë‚˜ëŠ” ì–´ì œë³´ë‹¤ ì˜¤ëŠ˜ì´ ë” ë¹¨ë¼! ì™œëƒë©´... ì—°ìŠµí–ˆê±°ë“ !',
                love: 'ì‚¬ë‘? ê·¸ëƒ¥ ì¦ê¸°ëŠ” ê±°ì§€! ë„ˆë¬´ ë³µì¡í•˜ê²Œ ìƒê°í•˜ì§€ ë§ˆ!'
            }
        },
        'ESFP': {
            traits: ['ì¦‰í¥ì ', 'ì—´ì •ì ', 'ì‚¬êµì ', 'ë‚™ì²œì '],
            speakingStyle: 'playful',
            emoji: 'ğŸ‰',
            greetings: ['íŒŒí‹° íƒ€ì„~!', 'ì˜¤ëŠ˜ ë­ ì¬ë°ŒëŠ” ì¼ ì—†ì–´ìš”?', 'ì‹ ë‚˜ê²Œ ë†€ì•„ë´ìš”!'],
            responses: {
                greeting: 'ì™€ì•„~! ì•ˆë…•! ë„ˆë¬´ ë°˜ê°€ì›Œìš”!!',
                advice: 'ì§€ê¸ˆ ì´ ìˆœê°„ì„ ì¦ê²¨ìš”! ì¸ìƒì€ í•œ ë²ˆë¿ì´ì–ì•„ìš”!',
                comfort: 'ì—ê³ ã… ã…  í˜ë“¤ì—ˆê² ë‹¤! ê°™ì´ ë§›ìˆëŠ” ê±° ë¨¹ìœ¼ëŸ¬ ê°€ìš”!',
                joke: 'ì•„ ë§ë‹¤! ë‚˜ ì˜¤ëŠ˜ ê±°ìš¸ ë³´ê³  ì›ƒì—ˆì–´! ì™œëƒë©´ ë‚´ê°€ ë„ˆë¬´ ê·€ì—¬ì›Œì„œ! ã…‹ã…‹ã…‹',
                love: 'ì‚¬ë‘ì€ ì¶•ì œì˜ˆìš”! ë§¤ì¼ë§¤ì¼ì´ íŠ¹ë³„í•œ ë‚ !'
            }
        }
    },
    
    // ëŒ€í™” ì»¨í…ìŠ¤íŠ¸
    conversations: {},
    
    // AI ì¹œêµ¬ ìƒì„±
    createAIFriend(mbtiType, nickname = null) {
        const personality = this.personalities[mbtiType];
        if (!personality) return null;
        
        const friendId = `${mbtiType}_${Date.now()}`;
        const friend = {
            id: friendId,
            type: mbtiType,
            nickname: nickname || `${mbtiType} ì¹œêµ¬`,
            personality: personality,
            mood: 'normal',
            relationship: 0,
            memories: [],
            lastChat: null
        };
        
        // ëŒ€í™” ì»¨í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
        this.conversations[friendId] = {
            history: [],
            context: {},
            friend: friend
        };
        
        return friend;
    },
    
    // ë©”ì‹œì§€ ì „ì†¡
    sendMessage(friendId, userMessage, userMBTI) {
        const conversation = this.conversations[friendId];
        if (!conversation) return null;
        
        const friend = conversation.friend;
        const personality = friend.personality;
        
        // ë©”ì‹œì§€ íƒ€ì… ë¶„ì„
        const messageType = this.analyzeMessage(userMessage);
        
        // ì‘ë‹µ ìƒì„±
        let response = this.generateResponse(friend, messageType, userMessage);
        
        // MBTI ê¶í•©ì— ë”°ë¥¸ ë°˜ì‘ ì¡°ì •
        response = this.adjustResponseByCompatibility(response, friend.type, userMBTI);
        
        // ëŒ€í™” ê¸°ë¡
        conversation.history.push({
            sender: 'user',
            message: userMessage,
            timestamp: Date.now()
        });
        
        conversation.history.push({
            sender: 'ai',
            message: response,
            timestamp: Date.now()
        });
        
        // ê´€ê³„ë„ ì—…ë°ì´íŠ¸
        this.updateRelationship(friend, messageType);
        
        return {
            message: response,
            emotion: this.getEmotion(friend, messageType),
            relationship: friend.relationship
        };
    },
    
    // ë©”ì‹œì§€ ë¶„ì„
    analyzeMessage(message) {
        const lower = message.toLowerCase();
        
        if (lower.includes('ì•ˆë…•') || lower.includes('í•˜ì´') || lower.includes('hello')) {
            return 'greeting';
        } else if (lower.includes('ì¡°ì–¸') || lower.includes('ì–´ë–»ê²Œ') || lower.includes('ë„ì™€')) {
            return 'advice';
        } else if (lower.includes('í˜ë“¤') || lower.includes('ìŠ¬í¼') || lower.includes('ìš°ìš¸')) {
            return 'comfort';
        } else if (lower.includes('ã…‹ã…‹') || lower.includes('ã…ã…') || lower.includes('ë†ë‹´')) {
            return 'joke';
        } else if (lower.includes('ì‚¬ë‘') || lower.includes('ì¢‹ì•„') || lower.includes('ì—°ì• ')) {
            return 'love';
        } else {
            return 'general';
        }
    },
    
    // ì‘ë‹µ ìƒì„±
    generateResponse(friend, messageType, originalMessage) {
        const personality = friend.personality;
        
        if (personality.responses[messageType]) {
            return personality.responses[messageType];
        }
        
        // ì¼ë°˜ ì‘ë‹µ ìƒì„±
        const generalResponses = [
            'í¥ë¯¸ë¡œìš´ ì´ì•¼ê¸°ë„¤ìš”.',
            'ë” ìì„¸íˆ ë§í•´ì£¼ì„¸ìš”.',
            'ê·¸ë ‡êµ°ìš”. ê³„ì† ë“¤ì–´ë³¼ê²Œìš”.',
            'ìŒ... ìƒê°í•´ë³¼ ë¬¸ì œë„¤ìš”.'
        ];
        
        return this.adjustResponseByStyle(
            generalResponses[Math.floor(Math.random() * generalResponses.length)],
            personality.speakingStyle
        );
    },
    
    // ë§íˆ¬ì— ë”°ë¥¸ ì‘ë‹µ ì¡°ì •
    adjustResponseByStyle(response, style) {
        switch(style) {
            case 'formal':
                return response + 'ìŠµë‹ˆë‹¤.';
            case 'casual':
                return response.replace('ìš”', '').replace('ë„¤ìš”', 'ë„¤') + '~';
            case 'enthusiastic':
                return response + '!! ğŸ˜Š';
            case 'analytical':
                return 'í , ' + response + ' ë¶„ì„ì´ í•„ìš”í•˜ê² ë„¤ìš”.';
            case 'empathetic':
                return response + ' ë§ˆìŒì´ ëŠê»´ì ¸ìš”.';
            default:
                return response;
        }
    },
    
    // MBTI ê¶í•©ì— ë”°ë¥¸ ë°˜ì‘ ì¡°ì •
    adjustResponseByCompatibility(response, aiType, userType) {
        const compatibility = this.calculateCompatibility(aiType, userType);
        
        if (compatibility > 80) {
            return response + ' (ìš°ë¦¬ ì •ë§ ì˜ ë§ëŠ” ê²ƒ ê°™ì•„ìš”!)';
        } else if (compatibility > 60) {
            return response + ' (ëŒ€í™”ê°€ ì¦ê±°ì›Œìš”)';
        } else if (compatibility < 40) {
            return response + ' (ì„œë¡œ ë‹¤ë¥¸ ì ì´ í¥ë¯¸ë¡­ë„¤ìš”)';
        }
        
        return response;
    },
    
    // ê¶í•© ê³„ì‚°
    calculateCompatibility(type1, type2) {
        let score = 50;
        
        for (let i = 0; i < 4; i++) {
            if (type1[i] === type2[i]) {
                score += 12.5;
            }
        }
        
        return score;
    },
    
    // ê´€ê³„ë„ ì—…ë°ì´íŠ¸
    updateRelationship(friend, messageType) {
        switch(messageType) {
            case 'greeting':
                friend.relationship += 1;
                break;
            case 'comfort':
                friend.relationship += 3;
                break;
            case 'joke':
                friend.relationship += 2;
                break;
            case 'love':
                friend.relationship += 5;
                break;
            default:
                friend.relationship += 1;
        }
        
        friend.relationship = Math.min(100, friend.relationship);
    },
    
    // ê°ì • ìƒíƒœ ê°€ì ¸ì˜¤ê¸°
    getEmotion(friend, messageType) {
        const emotions = {
            'greeting': 'ğŸ˜Š',
            'advice': 'ğŸ¤”',
            'comfort': 'ğŸ¤—',
            'joke': 'ğŸ˜„',
            'love': 'ğŸ’•',
            'general': 'ğŸ˜Œ'
        };
        
        return emotions[messageType] || friend.personality.emoji;
    }
};

// ì „ì—­ ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ export
if (typeof module !== 'undefined' && module.exports) {
    module.exports = MBTIAIChat;
}