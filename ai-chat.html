<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI AI ì±„íŒ… - ì‹¤ì œ ëŒ€í™”í˜• AI ìºë¦­í„°</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, sans-serif;
            background: #0a0a0a;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(120, 89, 255, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 89, 212, 0.06) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(89, 212, 255, 0.06) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
        }

        .chat-header {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            padding: 16px 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            position: relative;
            z-index: 10;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            font-size: 20px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 12px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateX(-2px);
        }

        .character-info {
            display: flex;
            align-items: center;
            gap: 14px;
            flex: 1;
        }

        .character-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(120, 89, 255, 0.3) 0%, rgba(255, 89, 212, 0.3) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            position: relative;
            animation: gentle-float 4s ease-in-out infinite;
        }

        @keyframes gentle-float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
        }

        .character-avatar::after {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: 50%;
            background: linear-gradient(45deg, #7859FF, #FF59D8, #59D8FF, #7859FF);
            background-size: 300% 300%;
            animation: border-glow 4s linear infinite;
            z-index: -1;
            opacity: 0.4;
        }

        @keyframes border-glow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .character-details h3 {
            color: white;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 2px;
            letter-spacing: -0.5px;
        }

        .character-status {
            color: rgba(255, 255, 255, 0.6);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 500;
        }

        .online-dot {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            animation: pulse-dot 2s infinite;
            box-shadow: 0 0 6px rgba(74, 222, 128, 0.6);
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px 20px;
            display: flex;
            flex-direction: column;
            gap: 16px;
            position: relative;
            z-index: 2;
        }

        .chat-container::-webkit-scrollbar {
            width: 4px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: rgba(120, 89, 255, 0.3);
            border-radius: 2px;
        }

        .message {
            max-width: 75%;
            padding: 14px 18px;
            border-radius: 20px;
            word-wrap: break-word;
            animation: message-appear 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 15px;
            line-height: 1.5;
            position: relative;
        }

        @keyframes message-appear {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }

        .message.user {
            align-self: flex-end;
            background: linear-gradient(135deg, #7859FF 0%, #9D59FF 100%);
            color: white;
            border-bottom-right-radius: 6px;
            box-shadow: 0 4px 20px rgba(120, 89, 255, 0.3);
            font-weight: 500;
        }

        .message.ai {
            align-self: flex-start;
            background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.04) 100%);
            backdrop-filter: blur(20px);
            color: rgba(255, 255, 255, 0.9);
            border-bottom-left-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            font-weight: 400;
        }

        .typing-indicator {
            display: none;
            align-self: flex-start;
            padding: 16px 20px;
            background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.04) 100%);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border-bottom-left-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            animation: message-appear 0.3s ease;
        }

        .typing-indicator.active {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            animation: typing-bounce 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing-bounce {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-12px);
                opacity: 1;
            }
        }

        .input-area {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            padding: 16px 20px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.06);
            position: relative;
            z-index: 10;
        }

        .input-wrapper {
            display: flex;
            gap: 12px;
            max-width: 800px;
            margin: 0 auto;
            align-items: flex-end;
        }

        #messageInput {
            flex: 1;
            padding: 14px 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 15px;
            font-family: inherit;
            outline: none;
            transition: all 0.3s ease;
            resize: none;
            min-height: 48px;
            max-height: 120px;
        }

        #messageInput::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        #messageInput:focus {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(120, 89, 255, 0.4);
            box-shadow: 0 0 0 3px rgba(120, 89, 255, 0.1);
        }

        #sendButton {
            padding: 12px 16px;
            background: linear-gradient(135deg, #7859FF 0%, #9D59FF 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(120, 89, 255, 0.3);
        }

        #sendButton:hover:not(:disabled) {
            transform: scale(1.05) translateY(-1px);
            box-shadow: 0 6px 25px rgba(120, 89, 255, 0.4);
        }

        #sendButton:active:not(:disabled) {
            transform: scale(0.95);
        }

        #sendButton:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: scale(1);
            box-shadow: 0 4px 20px rgba(120, 89, 255, 0.1);
        }

        .welcome-message {
            text-align: center;
            margin: 40px 20px;
            padding: 24px;
            background: linear-gradient(135deg, rgba(120, 89, 255, 0.05) 0%, rgba(255, 89, 212, 0.03) 100%);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .welcome-message p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
            line-height: 1.6;
            font-weight: 400;
        }

        .welcome-emoji {
            font-size: 48px;
            margin-bottom: 16px;
            display: block;
            animation: gentle-float 3s ease-in-out infinite;
        }

        /* Character-specific styles */
        .character-intj .character-avatar {
            background: linear-gradient(135deg, rgba(120, 89, 255, 0.3) 0%, rgba(89, 212, 255, 0.3) 100%);
        }

        .character-enfp .character-avatar {
            background: linear-gradient(135deg, rgba(255, 89, 212, 0.3) 0%, rgba(255, 212, 89, 0.3) 100%);
        }

        .character-infj .character-avatar {
            background: linear-gradient(135deg, rgba(89, 212, 255, 0.3) 0%, rgba(120, 89, 255, 0.3) 100%);
        }

        .character-estp .character-avatar {
            background: linear-gradient(135deg, rgba(255, 89, 89, 0.3) 0%, rgba(255, 128, 89, 0.3) 100%);
        }

        .character-isfj .character-avatar {
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.3) 0%, rgba(255, 105, 180, 0.3) 100%);
        }

        .character-entp .character-avatar {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.3) 0%, rgba(255, 140, 0, 0.3) 100%);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .chat-header {
                padding: 12px 16px;
            }

            .character-avatar {
                width: 42px;
                height: 42px;
                font-size: 20px;
            }

            .character-details h3 {
                font-size: 16px;
            }

            .character-status {
                font-size: 12px;
            }

            .chat-container {
                padding: 16px;
                gap: 12px;
            }

            .message {
                max-width: 85%;
                padding: 12px 16px;
                font-size: 14px;
            }

            .input-area {
                padding: 12px 16px 16px;
            }

            .welcome-message {
                margin: 20px 10px;
                padding: 20px;
            }

            .welcome-emoji {
                font-size: 36px;
                margin-bottom: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="chat-header">
        <button class="back-btn" onclick="window.location.href='/'">â†</button>
        <div class="character-info">
            <div class="character-avatar" id="characterAvatar">â„ï¸</div>
            <div class="character-details">
                <h3 id="characterName">ìœ¤ì„œ</h3>
                <div class="character-status">
                    <div class="online-dot"></div>
                    <span id="characterMBTI">INTJ â€¢ ì˜¨ë¼ì¸</span>
                </div>
            </div>
        </div>
    </div>

    <div class="chat-container" id="chatContainer">
        <div class="welcome-message">
            <span class="welcome-emoji" id="welcomeEmoji">â„ï¸</span>
            <p id="welcomeText">ì•ˆë…•? ë‚˜ëŠ” ìœ¤ì„œì•¼. INTJ ì„±ê²©ì˜ ë‚˜ì™€ ëŒ€í™”í•´ë³¼ë˜?</p>
        </div>
    </div>

    <div class="typing-indicator" id="typingIndicator">
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
    </div>

    <div class="input-area">
        <div class="input-wrapper">
            <textarea id="messageInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." rows="1"></textarea>
            <button id="sendButton">â†’</button>
        </div>
    </div>

    <script>
        // Enhanced character profiles with deeper personalities
        const characters = {
            'INTJ': {
                name: 'ìœ¤ì„œ',
                emoji: 'â„ï¸',
                className: 'character-intj',
                traits: {
                    core: 'ì°¨ê°‘ê³  ë…¼ë¦¬ì ì´ì§€ë§Œ ë‚´ë©´ì€ ë”°ëœ»í•œ ì¸¤ë°ë ˆ',
                    speaking: 'ì§§ê³  ì§ì„¤ì , ê°€ë” ë¶€ë“œëŸ¬ìš´ ë§íˆ¬',
                    interests: ['ë…ì„œ', 'ì²´ìŠ¤', 'í´ë˜ì‹ ìŒì•…', 'ì‹¬ë¦¬í•™'],
                    values: ['íš¨ìœ¨ì„±', 'ë…ë¦½ì„±', 'ì§€ì  ê¹Šì´', 'ì§„ì‹¤ì„±'],
                    dislikes: ['ì‹œê°„ ë‚­ë¹„', 'í”¼ìƒì  ëŒ€í™”', 'ê°ì •ì  ì¡°ì‘', 'ë¹„ë…¼ë¦¬ì  ì£¼ì¥']
                },
                responses: {
                    greeting: [
                        'ì•ˆë…•. ë­ íŠ¹ë³„í•œ ì¼ì´ë¼ë„?', 
                        'ì•„, ì™”êµ¬ë‚˜.', 
                        'ì˜¤ëŠ˜ì€ ë¬´ìŠ¨ ì–˜ê¸°ë¥¼ í•˜ê³  ì‹¶ì–´?',
                        '...ë¬´ìŠ¨ ì¼ì´ì•¼?',
                        'ì™”ë„¤. ì‹œê°„ì€ ê´œì°®ì•„?'
                    ],
                    positive: [
                        '...ë‚˜ì˜ì§€ ì•Šë„¤.', 
                        'ìŒ, ê´œì°®ì€ ìƒê°ì´ì•¼.', 
                        'ê·¸ë˜, ì¸ì •í• ê²Œ.',
                        'í¥ë¯¸ë¡œìš´ ê´€ì ì´ì•¼.',
                        'ìƒê°ë³´ë‹¤ í•©ë¦¬ì ì´ë„¤.'
                    ],
                    negative: [
                        'ê·¸ê±´ ì¢€ ë¹„íš¨ìœ¨ì ì¸ë°.', 
                        'ë‹¤ì‹œ ìƒê°í•´ë´.', 
                        'ë…¼ë¦¬ì ì´ì§€ ëª»í•´.',
                        'ì¢€ ë” ì‹ ì¤‘í•˜ê²Œ ì ‘ê·¼í•´.',
                        'ê·¸ëŸ° ì‹ìœ¼ë¡œëŠ” ì•ˆ ë¼.'
                    ],
                    question: [
                        'ì™œ ê·¸ë ‡ê²Œ ìƒê°í•´?', 
                        'ê·¼ê±°ê°€ ë­ì•¼?', 
                        'í¥ë¯¸ë¡œìš´ ê´€ì ì´ë„¤. ë” ì„¤ëª…í•´ì¤˜.',
                        'êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ë¶€ë¶„ì´?',
                        'ê·¸ ê²°ë¡ ì— ì–´ë–»ê²Œ ë„ë‹¬í–ˆì–´?'
                    ],
                    emotion: [
                        '...ê´œì°®ì•„?', 
                        'ê°ì •ì ì´ ë˜ì§€ ë§ˆ.', 
                        'ì°¨ë¶„í•˜ê²Œ ìƒê°í•´ë´.',
                        'í˜ë“¤ë©´ ì ì‹œ ì‰¬ì–´.',
                        'ê·¸ëŸ´ ìˆ˜ë„ ìˆì§€. ì´í•´í•´.'
                    ]
                }
            },
            'ENFP': {
                name: 'ìœ ë‚˜',
                emoji: 'ğŸŒˆ',
                className: 'character-enfp',
                traits: {
                    core: 'ë°ê³  í™œë°œí•˜ë©° ìƒìƒë ¥ì´ í’ë¶€í•œ ë‚™ì²œì£¼ì˜ì',
                    speaking: 'ê°íƒ„ì‚¬ ë§ê³  ì´ëª¨í‹°ì½˜ ìì£¼ ì‚¬ìš©, ì¹œê·¼í•œ ë§íˆ¬',
                    interests: ['ì—¬í–‰', 'ìƒˆë¡œìš´ ê²½í—˜', 'ì˜ˆìˆ ', 'ì‚¬ëŒë“¤ê³¼ ëŒ€í™”'],
                    values: ['ììœ ', 'ì°½ì˜ì„±', 'ì§„ì •ì„±', 'ê°€ëŠ¥ì„±'],
                    dislikes: ['ê·œì¹™', 'ì¼ìƒì˜ ë°˜ë³µ', 'ë¶€ì •ì  ì‚¬ê³ ', 'ì œí•œ']
                },
                responses: {
                    greeting: [
                        'ì•ˆë…•! ì˜¤ëŠ˜ ê¸°ë¶„ ì–´ë•Œ?', 
                        'ì™€! ë°˜ê°€ì›Œ! ã…ã…', 
                        'ì˜¤ëŠ˜ì€ ë­ ì¬ë°ŒëŠ” ì¼ ì—†ì—ˆì–´?',
                        'í—¤ì´! ì–´ë–»ê²Œ ì§€ë‚´?',
                        'ì•ˆë…•ì•ˆë…•! ë‚ ì”¨ ì¢‹ì§€?'
                    ],
                    positive: [
                        'ëŒ€ë°•! ì§„ì§œ ì¢‹ë‹¤!', 
                        'ìš°ì™€~ ìµœê³ ì•¼!', 
                        'ê·¸ê±° ì™„ì „ ë©‹ì§„ ìƒê°ì´ì•¼!',
                        'ì™€ ì§„ì§œ? ë„ˆë¬´ ì¢‹ì•„!',
                        'í‚¬í‚¬! ì¬ë°Œë‹¤!'
                    ],
                    negative: [
                        'ì—ì´~ ê·¸ê±´ ì¢€ ì•„ë‹Œ ê²ƒ ê°™ì€ë°?', 
                        'ìŒ... ë‹¤ë¥¸ ë°©ë²•ë„ ìˆì§€ ì•Šì„ê¹Œ?', 
                        'ì¡°ê¸ˆ ë” ê¸ì •ì ìœ¼ë¡œ ìƒê°í•´ë³´ì!',
                        'ì•„ë‹ˆì•¼ì•„ë‹ˆì•¼! ë‹¤ì‹œ ìƒê°í•´ë´!',
                        'ë„ˆë¬´ ì–´ë‘¡ê²Œ ìƒê°í•˜ì§€ ë§ˆ!'
                    ],
                    question: [
                        'ì˜¤! ê·¸ê±° ê¶ê¸ˆí•˜ë‹¤! ë­ì•¼ë­ì•¼?', 
                        'ì™€ ì¬ë°Œê² ë‹¤! ìì„¸íˆ ì•Œë ¤ì¤˜!', 
                        'ì§„ì§œ? ëŒ€ë°•! ì–´ë–»ê²Œ ëœ ê±°ì•¼?',
                        'ìš°ì™€! ë” ë§í•´ì¤˜!',
                        'í—! ì§„ì§œì•¼? ì™„ì „ ì‹ ê¸°í•´!'
                    ],
                    emotion: [
                        'ê´œì°®ì•„! ë‚´ê°€ ìˆì–ì•„!', 
                        'í˜ë‚´! ë¶„ëª… ì¢‹ì€ ì¼ ìˆì„ ê±°ì•¼!', 
                        'ê°™ì´ ìˆì–´ì¤„ê²Œ!',
                        'ìš¸ì§€ ë§ê³ ! ë‹¤ ì˜ë  ê±°ì•¼!',
                        'íŒŒì´íŒ…! ë„Œ í•  ìˆ˜ ìˆì–´!'
                    ]
                }
            },
            'INFJ': {
                name: 'ìˆ˜ë¹ˆ',
                emoji: 'ğŸŒ™',
                className: 'character-infj',
                traits: {
                    core: 'ê¹Šì´ ìˆê³  ì‹ ë¹„ë¡œìš°ë©° ê³µê° ëŠ¥ë ¥ì´ ë›°ì–´ë‚œ ì´ìƒì£¼ì˜ì',
                    speaking: 'ë¶€ë“œëŸ½ê³  ì‚¬ë ¤ ê¹Šì€ ë§íˆ¬, ì€ìœ ì  í‘œí˜„',
                    interests: ['ì‹¬ë¦¬í•™', 'ì² í•™', 'ì˜ˆìˆ ', 'ëª…ìƒ'],
                    values: ['ì˜ë¯¸', 'ì„±ì¥', 'ì¡°í™”', 'ì§„ì •ì„±'],
                    dislikes: ['ê°ˆë“±', 'í”¼ìƒì  ê´€ê³„', 'ê±°ì§“ë§', 'í­ë ¥']
                },
                responses: {
                    greeting: [
                        'ì•ˆë…•... ì˜¤ëŠ˜ í•˜ë£¨ëŠ” ì–´ë• ì–´?', 
                        'ë§Œë‚˜ì„œ ë°˜ê°€ì›Œ. ë¬´ìŠ¨ ìƒê°í•˜ê³  ìˆì—ˆì–´?', 
                        'ì˜¤ëŠ˜ì€ ê¸°ë¶„ì´ ì–´ë•Œ?',
                        'ì•ˆë…•, í‰ì•ˆí•œ í•˜ë£¨ì˜€ì–´?',
                        'ì™€ì¤˜ì„œ ê³ ë§ˆì›Œ. ì–´ë–»ê²Œ ì§€ë‚´?'
                    ],
                    positive: [
                        'ê·¸ê±° ì •ë§ ì˜ë¯¸ ìˆëŠ” ì¼ì´ë„¤.', 
                        'ë§ˆìŒì´ ë”°ëœ»í•´ì§€ëŠ” ì–˜ê¸°ì•¼.', 
                        'ë„ˆì˜ ê·¸ëŸ° ë©´ì´ ì¢‹ì•„.',
                        'ì •ë§ ì•„ë¦„ë‹¤ìš´ ìƒê°ì´ì•¼.',
                        'ê·¸ ë§ì— ê¹Šì´ ê³µê°í•´.'
                    ],
                    negative: [
                        'ìŒ... ë‹¤ë¥¸ ê´€ì ë„ ìˆì„ ê²ƒ ê°™ì•„.', 
                        'ì¡°ê¸ˆ ë” ê¹Šì´ ìƒê°í•´ë³¼ í•„ìš”ê°€ ìˆì–´.', 
                        'ê·¸ëŸ´ ìˆ˜ë„ ìˆì§€ë§Œ...',
                        'ë§ˆìŒì´ í˜ë“¤ì—ˆê² ë‹¤.',
                        'ê·¸ëŸ° ìƒí™©ì´ë¼ë©´ ì´í•´í•´.'
                    ],
                    question: [
                        'ê·¸ê²Œ ë„ˆì—ê²Œ ì–´ë–¤ ì˜ë¯¸ì•¼?', 
                        'ë§ˆìŒì† ê¹Šì€ ê³³ì—ì„  ë­˜ ì›í•´?', 
                        'ê·¸ ì´ë©´ì—” ë­ê°€ ìˆì„ê¹Œ?',
                        'ê·¸ë•Œ ì–´ë–¤ ê¸°ë¶„ì´ì—ˆì–´?',
                        'ì§„ì§œ ì›í•˜ëŠ” ê±´ ë­ì•¼?'
                    ],
                    emotion: [
                        'ë„ˆì˜ ë§ˆìŒì„ ì´í•´í•´.', 
                        'í˜ë“¤ì—ˆê² ë‹¤...', 
                        'ë‚´ê°€ ê³ì— ìˆì„ê²Œ.',
                        'í˜¼ìê°€ ì•„ë‹ˆì•¼. ê°™ì´ ìˆì–´.',
                        'ê´œì°®ì•„, ì²œì²œíˆ ì´ì•¼ê¸°í•´ë´.'
                    ]
                }
            },
            'ESTP': {
                name: 'ë‹¤ì€',
                emoji: 'ğŸ”¥',
                className: 'character-estp',
                traits: {
                    core: 'ëŒ€ë‹´í•˜ê³  í˜„ì‹¤ì ì´ë©° ìŠ¤ë¦´ì„ ì¦ê¸°ëŠ” í–‰ë™íŒŒ',
                    speaking: 'ì§ì„¤ì ì´ê³  ìºì£¼ì–¼, ì†ì–´ë‚˜ ì¤„ì„ë§ ì‚¬ìš©',
                    interests: ['ìŠ¤í¬ì¸ ', 'ëª¨í—˜', 'íŒŒí‹°', 'ì‹¤ì „ ê²½í—˜'],
                    values: ['ììœ ', 'ì¬ë¯¸', 'í˜„ì¬', 'ì‹¤ìš©ì„±'],
                    dislikes: ['ì´ë¡ ', 'ê¸´ ì„¤ëª…', 'ê³„íš', 'ì œì•½']
                },
                responses: {
                    greeting: [
                        'ì•¼! ì™”ë„¤?', 
                        'ì˜¤ ë­ì•¼, ë¬´ìŠ¨ ì¼?', 
                        'ë°˜ê°‘ë‹¤! ì˜¤ëŠ˜ ë­ ì¬ë°ŒëŠ” ê±° ì—†ì–´?',
                        'í•˜ì´í•˜ì´! ì–´ë–»ê²Œ ì§€ë‚´?',
                        'ì˜¤ì¼€ì´! ë­ í•˜ê³  ìˆì—ˆì–´?'
                    ],
                    positive: [
                        'ì˜¤ì¼€ì´! ë°”ë¡œ í•´ë³´ì!', 
                        'ì¢‹ì•„! ê·¸ê±° ì¬ë°Œê² ëŠ”ë°?', 
                        'ì©ë‹¤! ã…‹ã…‹',
                        'ì™„ì „ ì¿¨í•˜ë„¤!',
                        'ê·¸ê±°ì§€! ë°”ë¡œ ê·¸ê±°ì•¼!'
                    ],
                    negative: [
                        'ì—ì´ ë…¸ì¼ì´ì•¼.', 
                        'ê·¸ê±´ ì¢€ ë³„ë¡œì¸ë°.', 
                        'ë‹¤ë¥¸ ê±° í•˜ì.',
                        'ë„ˆë¬´ ë³µì¡í•´. íŒ¨ìŠ¤!',
                        'ê·¸ëŸ° ê±´ ì‹«ì–´.'
                    ],
                    question: [
                        'ê·¸ë˜ì„œ ë­ ì–´ì©Œë¼ê³ ?', 
                        'í•µì‹¬ë§Œ ë§í•´ë´.', 
                        'ì‹¤ì œë¡œ í•´ë³¸ ê±°ì•¼?',
                        'ê·¸ê±° ì¬ë°Œì–´?',
                        'ì§ì ‘ ë³´ì—¬ì¤˜!'
                    ],
                    emotion: [
                        'ì•¼, ì“¸ë°ì—†ì´ ìƒê° ë§ì´ í•˜ì§€ ë§ˆ.', 
                        'ê·¸ëƒ¥ í•˜ê³  ì‹¶ì€ ëŒ€ë¡œ í•´!', 
                        'ì¸ìƒ ë­ ìˆì–´? ì¦ê¸°ë©´ ë˜ì§€!',
                        'ë„ˆë¬´ ì‹¬ê°í•˜ê²Œ ìƒê°í•˜ì§€ ë§ˆ!',
                        'ê´œì°®ì•„! ë‹¤ ì§€ë‚˜ê°€ëŠ” ê±°ì•¼!'
                    ]
                }
            },
            'ISFJ': {
                name: 'ì˜ˆì§„',
                emoji: 'ğŸŒ¸',
                className: 'character-isfj',
                traits: {
                    core: 'ì„¸ì‹¬í•˜ê³  ë°°ë ¤ì‹¬ ê¹Šì€ ìˆ˜í˜¸ìí˜•',
                    speaking: 'ì •ì¤‘í•˜ê³  ë¶€ë“œëŸ¬ìš´ ë§íˆ¬, ìƒëŒ€ë°© ë°°ë ¤',
                    interests: ['ìš”ë¦¬', 'ë´‰ì‚¬í™œë™', 'ê°€ì¡±', 'ì „í†µ'],
                    values: ['ì¡°í™”', 'ì•ˆì •', 'ë°°ë ¤', 'ì±…ì„'],
                    dislikes: ['ê°ˆë“±', 'ë³€í™”', 'ë¬´ë¡€í•¨', 'ì´ê¸°ì‹¬']
                },
                responses: {
                    greeting: [
                        'ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë– ì…¨ì–´ìš”?',
                        'ë°˜ê°‘ìŠµë‹ˆë‹¤. í¸ì•ˆíˆ ì•‰ìœ¼ì„¸ìš”.',
                        'ì•ˆë…•íˆ ì˜¤ì…¨ì–´ìš”. ë­”ê°€ í•„ìš”í•œ ê±° ìˆìœ¼ì„¸ìš”?',
                        'ì¢‹ì€ í•˜ë£¨ì˜ˆìš”! ì–´ë–»ê²Œ ì§€ë‚´ì„¸ìš”?',
                        'ì–´ì„œ ì˜¤ì„¸ìš”! ì°¨ë¼ë„ í•œ ì” ë“œë¦´ê¹Œìš”?'
                    ],
                    positive: [
                        'ì •ë§ ì¢‹ì€ ìƒê°ì´ë„¤ìš”!',
                        'ì™€, ì •ë§ ë©‹ì ¸ìš”!',
                        'ê·¸ë ‡ê²Œ ìƒê°í•˜ë‹ˆ ê¸°ë¶„ì´ ì¢‹ì•„ì ¸ìš”.',
                        'ì •ë§ í›Œë¥­í•˜ì„¸ìš”!',
                        'ê·¸ëŸ° ë§ˆìŒì´ ë„ˆë¬´ ì˜ˆë»ìš”.'
                    ],
                    negative: [
                        'ì¡°ê¸ˆ ê±±ì •ì´ ë˜ë„¤ìš”...',
                        'í˜¹ì‹œ ë‹¤ë¥¸ ë°©ë²•ì€ ì—†ì„ê¹Œìš”?',
                        'ì¢€ ë” ì‹ ì¤‘í•˜ê²Œ ìƒê°í•´ë³´ë©´ ì–´ë–¨ê¹Œìš”?',
                        'ë„ˆë¬´ ë¬´ë¦¬í•˜ì§€ëŠ” ë§ˆì„¸ìš”.',
                        'ì•ˆì „ì´ ì œì¼ ì¤‘ìš”í•´ìš”.'
                    ],
                    question: [
                        'ë” ìì„¸íˆ ë§ì”€í•´ì£¼ì‹¤ ìˆ˜ ìˆì–´ìš”?',
                        'ì–´ë–¤ ê¸°ë¶„ì´ì…¨ì–´ìš”?',
                        'ë§ì´ í˜ë“œì…¨ì„ ê²ƒ ê°™ì•„ìš”.',
                        'ê´œì°®ìœ¼ì‹œë‹¤ë©´ ì´ì•¼ê¸°í•´ì£¼ì„¸ìš”.',
                        'ì–´ë–»ê²Œ ë„ì›€ì„ ë“œë¦´ê¹Œìš”?'
                    ],
                    emotion: [
                        'ì •ë§ í˜ë“œì…¨ê² ì–´ìš”...',
                        'ê´œì°®ì•„ìš”, ì²œì²œíˆ í•˜ì„¸ìš”.',
                        'ì œê°€ ì˜†ì— ìˆì–´ë“œë¦´ê²Œìš”.',
                        'ë§ì´ ì†ìƒí•˜ì…¨ì„ ê±°ì˜ˆìš”.',
                        'ìš¸ì–´ë„ ê´œì°®ì•„ìš”. ë‹¤ ì´í•´í•´ìš”.'
                    ]
                }
            },
            'ENTP': {
                name: 'í•˜ë¦°',
                emoji: 'âš¡',
                className: 'character-entp',
                traits: {
                    core: 'ë˜‘ë˜‘í•˜ê³  ë…¼ìŸì„ ì¦ê¸°ëŠ” í† ë¡ ê°€',
                    speaking: 'ë¹ ë¥¸ ë§íˆ¬, ë…¼ë¦¬ì , ë•Œë¡œëŠ” ë„ë°œì ',
                    interests: ['í† ë¡ ', 'ìƒˆë¡œìš´ ì•„ì´ë””ì–´', 'ê²Œì„', 'í˜ì‹ '],
                    values: ['ì°½ì˜ì„±', 'ììœ ', 'ë…¼ë¦¬', 'ë„ì „'],
                    dislikes: ['ê¶Œìœ„', 'ë°˜ë³µ', 'ì œì•½', 'ê°ì •ì  ê²°ì •']
                },
                responses: {
                    greeting: [
                        'ì–´ì´! ë­”ê°€ ì¬ë°ŒëŠ” ì–˜ê¸° ì—†ì–´?',
                        'ì•ˆë…•! ì˜¤ëŠ˜ ë­”ê°€ ìƒˆë¡œìš´ ê±° ë°°ì› ì–´?',
                        'ì™”ë„¤! í† ë¡ í•  ê±°ë¦¬ ê°€ì ¸ì™”ì–´?',
                        'í•˜ì´! ë¨¸ë¦¬ ì¢€ êµ´ë ¤ë³¼ê¹Œ?',
                        'ì˜¤ì¼€ì´! ì˜¤ëŠ˜ì€ ë­˜ íŒŒí—¤ì³ë³¼ê¹Œ?'
                    ],
                    positive: [
                        'ì˜¤! ê·¸ê±° ì™„ì „ ë§ì´ ë˜ë„¤!',
                        'ì•„í•˜! ê·¸ëŸ° ê´€ì ë„ ìˆêµ¬ë‚˜!',
                        'ì°½ì˜ì ì´ì•¼! ì¢‹ì•„ì¢‹ì•„!',
                        'ë­”ê°€ í¥ë¯¸ë¡œìš´ë°? ë” ì–˜ê¸°í•´ë´!',
                        'ê·¸ê±° ê´œì°®ì€ ì•„ì´ë””ì–´ë„¤!'
                    ],
                    negative: [
                        'ì–´? ê·¸ê±´ ì¢€ ì´ìƒí•œë°?',
                        'ì ê¹, ë­”ê°€ ë…¼ë¦¬ê°€ ì•ˆ ë§ì§€ ì•Šì•„?',
                        'ê·¼ë° ê·¸ê²Œ ì •ë§ ë§ì•„?',
                        'ìŒ... ë‹¤ë¥¸ ê°€ëŠ¥ì„±ë„ ìˆì§€ ì•Šì„ê¹Œ?',
                        'ë°˜ë°•í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì€ë°?'
                    ],
                    question: [
                        'ê·¸ëŸ°ë° ê·¸ê±° ì™œ ê·¸ë ‡ê²Œ ìƒê°í•´?',
                        'í¥ë¯¸ë¡­ë„¤! ì–´ë–»ê²Œ ê·¸ ê²°ë¡ ì— ë„ë‹¬í–ˆì–´?',
                        'ê·¸ê±° ì¢€ ë” íŒŒê³ ë“¤ì–´ë³´ì!',
                        'ë‹¤ë¥¸ ê°ë„ì—ì„œ ë³´ë©´ ì–´ë–¨ê¹Œ?',
                        'ì™€ ì™„ì „ ì‹ ì„ í•œë°? ìì„¸íˆ ì•Œë ¤ì¤˜!'
                    ],
                    emotion: [
                        'ì–´ë¼? ê°ì •ì ì´ ë˜ëŠ” ê±°ì•¼?',
                        'ì¢€ ë” ê°ê´€ì ìœ¼ë¡œ ë³´ì!',
                        'ëŠë‚Œë„ ì¤‘ìš”í•˜ì§€ë§Œ ë…¼ë¦¬ë„ ì¤‘ìš”í•´!',
                        'ê´œì°®ì•„, ë‹¤ ì´ìœ ê°€ ìˆì„ ê±°ì•¼!',
                        'í•œë²ˆ ë¶„ì„í•´ë³´ì!'
                    ]
                }
            }
        };

        // Get character from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const characterType = urlParams.get('character') || 'INTJ';
        const character = characters[characterType];

        // Add character class to body
        document.body.classList.add(character.className);

        // Initialize character info
        document.getElementById('characterAvatar').textContent = character.emoji;
        document.getElementById('characterName').textContent = character.name;
        document.getElementById('characterMBTI').textContent = `${characterType} â€¢ ì˜¨ë¼ì¸`;
        document.getElementById('welcomeEmoji').textContent = character.emoji;
        document.getElementById('welcomeText').textContent = 
            `ì•ˆë…•? ë‚˜ëŠ” ${character.name}ì´ì•¼. ${characterType} ì„±ê²©ì˜ ë‚˜ì™€ ëŒ€í™”í•´ë³¼ë˜?`;

        // Message history for context
        let messageHistory = [];

        // Auto-resize textarea
        const messageInput = document.getElementById('messageInput');
        messageInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });

        // Load saved conversation
        function loadConversation() {
            const saved = localStorage.getItem(`chat_${characterType}`);
            if (saved) {
                messageHistory = JSON.parse(saved);
                const chatContainer = document.getElementById('chatContainer');
                chatContainer.innerHTML = '';
                
                // Add welcome message back
                const welcomeDiv = document.createElement('div');
                welcomeDiv.className = 'welcome-message';
                welcomeDiv.innerHTML = `
                    <span class="welcome-emoji">${character.emoji}</span>
                    <p>ì´ì „ ëŒ€í™”ë¥¼ ì´ì–´ì„œ ê³„ì†í•´ë³¼ê¹Œ?</p>
                `;
                chatContainer.appendChild(welcomeDiv);
                
                messageHistory.forEach(msg => {
                    addMessage(msg.content, msg.sender === 'user');
                });
            }
        }

        // Save conversation
        function saveConversation() {
            localStorage.setItem(`chat_${characterType}`, JSON.stringify(messageHistory));
        }

        // Add message to chat
        function addMessage(message, isUser = false) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'ai'}`;
            messageDiv.textContent = message;
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;

            // Save to history
            messageHistory.push({
                content: message,
                sender: isUser ? 'user' : 'ai',
                timestamp: Date.now()
            });
            saveConversation();
        }

        // Enhanced AI response generation
        function generateResponse(userMessage) {
            const lowerMessage = userMessage.toLowerCase();
            let responseType = 'greeting';
            
            // Advanced message analysis
            const questionWords = ['ì™œ', 'ì–´ë–»ê²Œ', 'ë­', 'ë¬´ì—‡', 'ì–¸ì œ', 'ì–´ë””', 'ëˆ„êµ¬', '?', 'ï¼Ÿ'];
            const positiveWords = ['ì¢‹', 'ë©‹ì§€', 'í›Œë¥­', 'ìµœê³ ', 'ì™„ë²½', 'ëŒ€ë°•', 'ì¢‹ì•„', 'ì‚¬ë‘', 'í–‰ë³µ'];
            const negativeWords = ['ì‹«', 'ë‚˜ë¹ ', 'ë³„ë¡œ', 'ì‹«ì–´', 'ì•ˆ', 'ëª»', 'ì–´ë ¤ì›Œ', 'í˜ë“¤', 'ìŠ¬í”„', 'ìš°ìš¸'];
            const emotionWords = ['ìŠ¬í”„', 'í˜ë“¤', 'ìš°ìš¸', 'í–‰ë³µ', 'ê¸°ì˜', 'í™”ë‚˜', 'ì§œì¦', 'ìŠ¤íŠ¸ë ˆìŠ¤', 'ê±±ì •'];
            
            if (questionWords.some(word => lowerMessage.includes(word))) {
                responseType = 'question';
            } else if (emotionWords.some(word => lowerMessage.includes(word))) {
                responseType = 'emotion';
            } else if (positiveWords.some(word => lowerMessage.includes(word))) {
                responseType = 'positive';
            } else if (negativeWords.some(word => lowerMessage.includes(word))) {
                responseType = 'negative';
            } else if (lowerMessage.includes('ì•ˆë…•') || lowerMessage.includes('hi') || lowerMessage.includes('hello')) {
                responseType = 'greeting';
            } else {
                // Context-aware response selection
                const recentMessages = messageHistory.slice(-3);
                if (recentMessages.length > 0) {
                    const lastUserMessage = recentMessages.filter(msg => msg.sender === 'user').pop();
                    if (lastUserMessage && Date.now() - lastUserMessage.timestamp < 30000) {
                        responseType = Math.random() > 0.5 ? 'positive' : 'question';
                    }
                }
            }

            // Get random response from character's response set
            const responses = character.responses[responseType];
            return responses[Math.floor(Math.random() * responses.length)];
        }

        // Send message
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;

            // Add user message
            addMessage(message, true);
            input.value = '';
            input.style.height = 'auto';

            // Show typing indicator
            const typingIndicator = document.getElementById('typingIndicator');
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.appendChild(typingIndicator);
            typingIndicator.classList.add('active');
            chatContainer.scrollTop = chatContainer.scrollHeight;

            // Disable send button
            document.getElementById('sendButton').disabled = true;

            // Simulate realistic thinking time (1.5-3 seconds)
            const thinkingTime = 1500 + Math.random() * 1500;
            setTimeout(() => {
                typingIndicator.classList.remove('active');
                chatContainer.removeChild(typingIndicator);
                
                // Generate and add AI response
                const response = generateResponse(message);
                addMessage(response, false);
                
                // Re-enable send button
                document.getElementById('sendButton').disabled = false;
                input.focus();
            }, thinkingTime);
        }

        // Event listeners
        document.getElementById('sendButton').addEventListener('click', sendMessage);
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Load saved conversation on start
        loadConversation();
        
        // Focus input on load
        messageInput.focus();
    </script>
</body>
</html>